/*! Version=16.0.6830.2200 */
Type.registerNamespace("Common.App.NewAndOpen.Core");Common.App.NewAndOpen.Core.k=function(){};Common.App.NewAndOpen.Core.k.prototype={a:function(){return this.e},f:function(a){Diag.a.a(5849616,202,50,"Changing event result state. {0}",{OldState:Common.bZ.toString(this.e),NewState:Common.bZ.toString(a)},"ResultType",this.i());this.e=a;return a},e:0};Common.App.NewAndOpen.Core.h=function(a,b){this.e=a;this.d=Common.App.NewAndOpen.Core.h.$$(this.$$gta["Common.App.NewAndOpen.Core.h"].T).a++;this.f=b};Common.App.NewAndOpen.Core.h.$$=function(d){var b="h$"+d.getName().replace(/\./g,"_");if(!Common.App.NewAndOpen.Core[b]){var a=Common.App.NewAndOpen.Core[b]=function(){for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];Common.App.NewAndOpen.Core.h.apply(this,b)};a.registerClass("Common.App.NewAndOpen.Core."+b,null,Common.fk.$$(d));var g={"Common.App.NewAndOpen.Core.h":{T:d}};a.prototype.$$gta=g;var e=Common.App.NewAndOpen.Core.h.prototype;for(var f in e){var c={key:f,value:e[f]};if("constructor"!==c.key)a.prototype[c.key]=c.value}a.a=0}return Common.App.NewAndOpen.Core[b]};Common.App.NewAndOpen.Core.h.prototype={e:null,f:null,d:0,c:function(){return this.d},b:function(a,b){this.f(a,b)},a:function(a,b){return this.e.a(a,b?this:null)}};Common.App.NewAndOpen.Core.f=function(){this.g={}};Common.App.NewAndOpen.Core.f.$$=function(d){var a="f$"+d.getName().replace(/\./g,"_");if(!Common.App.NewAndOpen.Core[a]){var c=Common.App.NewAndOpen.Core[a]=function(){for(var b=[],a=0;a<arguments.length;++a)b[a]=arguments[a];Common.App.NewAndOpen.Core.f.apply(this,b)};c.registerClass("Common.App.NewAndOpen.Core."+a,null,Common.fj.$$(d));var g={"Common.App.NewAndOpen.Core.f":{T:d}};c.prototype.$$gta=g;var e=Common.App.NewAndOpen.Core.f.prototype;for(var f in e){var b={key:f,value:e[f]};if("constructor"!==b.key)c.prototype[b.key]=b.value}}return Common.App.NewAndOpen.Core[a]};Common.App.NewAndOpen.Core.f.prototype={B:function(a){this.g[a.c().toString()]=a},C:function(e){var a=this.g;for(var b in a){var c={key:b,value:a[b]},d=c.value;d.b(e,false)}this.g={}},a:function(b,a){a&&this.B(a);return this.D(b,a)},j:function(a){this.C(a)},q:function(a,b){a.b(b,true)}};Common.App.NewAndOpen.Core.g=function(){this.g=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.h)};Common.App.NewAndOpen.Core.g.prototype={d:null,a:function(){return"Common.App.NewAndOpen.Core"},c:function(a){this.d=a;var b=this;a.b(Common.bo).e().f(function(){return Common.App.NewAndOpen.Core.c.a()});var c=this;a.b(Common.fj.$$(Common.be)).e().f(function(){return Common.App.NewAndOpen.Core.d.b()});var d=this;a.b(Common.fj.$$(Common.bu)).e().f(function(){return Common.App.NewAndOpen.Core.a.a()})},b:function(){var a=this;Common.a.b.e(function(){a.k()})},k:function(){this.d.a(Common.bo);this.d.a(Common.fj.$$(Common.be));this.d.a(Common.fj.$$(Common.bu));var a=false;Common.App.NewAndOpen.Core.c.a().w();if(Common.a.Q)a=true;if(Common.a.bj){Common.App.NewAndOpen.Core.a.a().M();Common.a.bh>0&&this.h();this.l();a=true}Common.a.bk&&a&&Common.App.NewAndOpen.Core.d.b().m();if(Common.a.bO){var b=Common.App.NewAndOpen.Core.a.a();b.Q();b.P();this.m()}},l:function(){Common.App.NewAndOpen.Core.b.a().i(Common.App.NewAndOpen.Core.a.a().v);Common.App.NewAndOpen.Core.b.a().i(this.f);Common.App.NewAndOpen.Core.b.a().m(this.g)},m:function(){Common.App.NewAndOpen.Core.b.a().m(Common.App.NewAndOpen.Core.a.a().x);Common.App.NewAndOpen.Core.b.a().i(Common.App.NewAndOpen.Core.a.a().w)},j:function(){Common.v.a().b(this.i())},h:function(){Common.v.a().a(this.i())},i:function(){return this.e||(this.e=new Common.G(4,2,Common.a.bh,Common.App.NewAndOpen.Core.a.a().u))},e:null,dispose:function(){}};Common.App.NewAndOpen.Core.i=function(){Common.App.NewAndOpen.Core.i.initializeBase(this);this.f(0);this.g=false;this.j=false};Common.App.NewAndOpen.Core.i.prototype={k:null,b:function(){return this.k},h:null,c:function(){return this.h},g:false,d:function(){return this.g},j:false,i:function(){return"GetMoreInfo Result"}};Common.App.NewAndOpen.Core.d=function(a,b){Common.App.NewAndOpen.Core.d.initializeBase(this);this.e=a;this.c=new Common.App.NewAndOpen.Core.e(b,this.d().f(),"GetMoreInfo");this.b=new Common.App.NewAndOpen.Core.i};Common.App.NewAndOpen.Core.d.b=function(){return Common.App.NewAndOpen.Core.d.a||(Common.App.NewAndOpen.Core.d.a=Common.App.NewAndOpen.Core.d.c())};Common.App.NewAndOpen.Core.d.c=function(){return new Common.App.NewAndOpen.Core.d(new($$sc.r.$$(Common.bo))(function(){return Common.App.NewAndOpen.Core.c.a()}),new($$sc.r.$$(String))(function(){return Common.a.bE}))};Common.App.NewAndOpen.Core.d.d=function(a){if(!a){Diag.a.a(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl.");return false}var b=a.toLowerCase();if(b.startsWith("https://"))return true;Diag.a.a(5849625,202,10,"StorageUrl has invalid scheme.");return false};Common.App.NewAndOpen.Core.d.prototype={e:null,c:null,b:null,m:function(){this.f("Document opened",false)},l:function(b){var a=this;return function(){a.f(b,true)}},D:function(a,b){Diag.a.a(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{Trigger:a});if(this.b.e===3){b&&this.q(b,this.b);Diag.a.a(5849619,202,50,"GetMoreInfo already populated. {0}",{Trigger:a})}else this.f(a,false);return this.b},f:function(a,c){this.c.b(!c);if(this.b.e===1){Diag.a.a(5849620,202,50,"Not starting new request, because one is already in progress {0}",{Trigger:a,RetryIndex:this.c.a});return}Diag.a.a(5849621,202,50,"Making GetMoreInfo request {0}",{Trigger:a,RetryIndex:this.c.a});this.b.f(1);var b=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.d().e(),Common.a.m),d=this.d().d().f(b,1,null,null,["PersonalFileStorageUrl","StorageServiceDisplayName"],false,4,this.k(a),this.i(a),null,null,false,null,null)},k:function(){var a=this;return function(f){var b=false,c=false,d=f.a.g;if(d){a.b.h=(d.StorageServiceDisplayName||"").toString();var e=(d.PersonalFileStorageUrl||"").toString();a.b.k=Common.App.NewAndOpen.Core.d.d(e)?e:"";b=e===""&&a.b.h!==""}else{Diag.a.a(5849622,202,50,"Null response headers received.");c=true}var g=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}",a.c.a,c,b);a.d().a("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",f.a,g);a.h(3,b,c)}},i:function(b){var a=this;return function(c){a.d().a("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",c.a,"Failure");a.h(2,false,false);a.c.h(a.l(b))}},h:function(a,b,c){this.b.f(a);this.b.g=b;this.b.j=c;this.j(this.b)},d:function(){return this.e.a()}};Common.App.NewAndOpen.Core.b=function(a,b,c,d,e){this.k=Function.createDelegate(this,this.p);this.f=a;this.b=b;this.e=c;this.g=d;this.a=new Common.C;e&&this.q();this.d=this.b()};Common.App.NewAndOpen.Core.b.a=function(){return Common.App.NewAndOpen.Core.b.b||(Common.App.NewAndOpen.Core.b.b=Common.App.NewAndOpen.Core.b.c())};Common.App.NewAndOpen.Core.b.c=function(){return new Common.App.NewAndOpen.Core.b(new($$sc.r.$$(Common.cu))(function(){return Common.v.a()}),function(){return Common.a.bQ.getTime()},function(){return+new Date},new($$sc.r.$$(Number))(function(){return Common.a.bM}),true)};Common.App.NewAndOpen.Core.b.prototype={l:6e4,d:0,f:null,b:null,e:null,g:null,a:null,j:"inactive",h:"active",c:true,i:function(a){this.a.r(this.h,a)},m:function(a){this.a.r(this.j,a)},q:function(){var a=new Common.G(4,2,this.l,this.k);this.o().a(a)},p:function(){var a=this.b(),c=this.e(),b=c-a;if(b>this.n()&&this.c){Diag.a.a(5849626,202,50,"User went inactive {0}",{TimeSinceLastActive:b});this.c=false;this.a.q(this.j)}if(a-this.d>this.n()){this.c=true;this.a.q(this.h)}this.d=a},o:function(){return this.f.a()},n:function(){return this.g.a()}};Common.App.NewAndOpen.Core.j=function(){Common.App.NewAndOpen.Core.j.initializeBase(this);this.f(0);this.d=false};Common.App.NewAndOpen.Core.j.prototype={g:null,b:function(){return this.g},h:0,c:function(){return this.h},d:false,i:function(){return"MruActor Result"}};Common.App.NewAndOpen.Core.a=function(a,b,c,d){this.s=Function.createDelegate(this,this.I);this.r=Function.createDelegate(this,this.H);this.t=Function.createDelegate(this,this.J);this.z=Function.createDelegate(this,this.T);this.y=Function.createDelegate(this,this.R);this.u=Function.createDelegate(this,this.K);this.w=Function.createDelegate(this,this.N);this.x=Function.createDelegate(this,this.O);this.v=Function.createDelegate(this,this.L);Common.App.NewAndOpen.Core.a.initializeBase(this);this.l=a;this.k=b;this.e=new Common.App.NewAndOpen.Core.e(c,this.b().f(),"Read");this.f=new Common.App.NewAndOpen.Core.e(d,this.b().f(),"Write");this.d={};this.c=new Common.App.NewAndOpen.Core.j};Common.App.NewAndOpen.Core.a.a=function(){return Common.App.NewAndOpen.Core.a.d||(Common.App.NewAndOpen.Core.a.d=Common.App.NewAndOpen.Core.a.f())};Common.App.NewAndOpen.Core.a.f=function(){return new Common.App.NewAndOpen.Core.a(new($$sc.r.$$(Common.bo))(function(){return Common.App.NewAndOpen.Core.c.a()}),new($$sc.r.$$(String))(function(){return Common.K.a(Common.a.f).a}),new($$sc.r.$$(String))(function(){return Common.a.bI}),new($$sc.r.$$(String))(function(){return Common.a.bJ}))};Common.App.NewAndOpen.Core.a.prototype={l:null,k:null,c:null,e:null,f:null,d:null,n:"RenameMruEntry",o:"UpdateMruEntry",Q:function(){var a=this.b().h();a.a(2391221446,2147483648,this.y)},R:function(c,d,e,f,b){var a=b;if(!a)return 32;if(!a.b){Diag.a.a(5849666,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewDocumentDAVUrl"});return 8}if(!a.c){Diag.a.a(5849667,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewFileName"});return 8}if(!a.a){Diag.a.a(5849668,202,15,"Failure to rename MRU entry {0}",{Error:"Null CurrentDocumentDAVUrl"});return 8}this.d[Common.App.NewAndOpen.Core.a.c]=this.d[Common.App.NewAndOpen.Core.a.c]||Common.d.b(a.a);this.d[Common.App.NewAndOpen.Core.a.b]=Common.d.b(a.b);this.d[Common.App.NewAndOpen.Core.a.e]=Common.d.b(a.c);Diag.a.a(5849669,202,50,"Starting rename of MRU entry {0}",{Trigger:"Rename"});return this.p("Rename",this.n,false)},P:function(){this.m("File Opened")},O:function(){this.m("Inactivity")},N:function(){this.m("Back from Inactivity")},m:function(a){Diag.a.a(5849670,202,50,"Starting update of MRU entry {0}",{Trigger:a});this.p(a,this.o,false)},p:function(e,b,f){if(this.b().b()===4&&!Common.a.bg)return 2;var a;if(!this.d[Common.App.NewAndOpen.Core.a.b]||this.d[Common.App.NewAndOpen.Core.a.c]===this.d[Common.App.NewAndOpen.Core.a.b]){a=this.o;delete this.d[Common.App.NewAndOpen.Core.a.b]}else a=this.n;Diag.a.a(5849673,202,50,"Writing to MRU {0}",{Trigger:e,IntendedActionType:b,ActualActionType:a});this.f.b(!f);var c=String.format(this.b().e()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}",a,this.b().b(),this.A(),Common.a.m),d=this.b().d().a(c,2,null,this.d,true,4,this.z,this.F(b),null,null,false,null,null,null);return d},T:function(b){this.b().a("MruActor.WriteMruEntryOnServerSuccessCallback",b.a,"Success");this.f.b(true);var a=(b.a.c.get_headers()[Common.App.NewAndOpen.Core.a.b]||"").toString();if(a!=="")this.d[Common.App.NewAndOpen.Core.a.c]=a},F:function(b){var a=this;return function(c){a.b().a("MruActor.WriteMruEntryOnServerFailureCallback",c.a,"Failure");c.a.f!==403&&a.f.h(a.G(b))}},G:function(b){var a=this;return function(){a.p("Retry",b,true)}},K:function(){this.h("Polling",false)},I:function(){this.h("Retry",true)},M:function(){this.h("Open",false)},L:function(){this.h("Activity",false)},h:function(a,b){Diag.a.a(5849674,202,50,"Making GetMru request {0}",{Trigger:a});this.e.b(!b);this.E(this.t,this.r,"getmru")},J:function(b){var c=b.a.b;this.e.b(true);var a=null;if(c)a=this.S(c);if(a){this.i(3,a,false);this.b().a("MruActor.GetMruFromServerSuccessCallback",b.a,"Success")}else{this.b().a("MruActor.GetMruFromServerSuccessCallback",b.a,"Failure: Invalid JSON");this.i(3,null,true)}this.j(this.c)},H:function(b){this.b().a("MruActor.GetMruFromServerFailureCallback",b.a,"Failure");this.i(2,null,false);var a=this.e.h(this.s);!a&&this.e.b(true);this.j(this.c)},i:function(a,b,c){if(this.c.e!==3||a===3){this.c.g=b;this.c.f(a);this.c.d=c;this.c.h=this.b().g()()}},D:function(b,a){Diag.a.a(6029918,202,50,"MRU result requested {0}",{Trigger:b,ResultState:this.c.e});if(a)this.c.e===3&&this.q(a,this.c);return this.c},E:function(b,c,d){this.i(1,null,false);var a=String.format(this.b().e()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}",d,this.b().b(),this.A(),Common.a.m),e=this.b().d().a(a,1,null,null,true,4,b,c,null,null,false,null,null,null)},S:function(b){var a;try{a=Common.A.e(b)}catch(c){a=null;Diag.a.a(5849675,202,10,"MruActor.TryDeserializeJson: Exception thrown from JsonSerializer.SecureDeserialize Exception: {0} Json: {1}",c,b)}return a},b:function(){return this.l.a()},A:function(){return this.k.a()}};Common.App.NewAndOpen.Core.e=function(a,b,c){this.g=a;this.f=b;this.e=c};Common.App.NewAndOpen.Core.e.prototype={c:null,g:null,d:null,e:"",f:null,b:function(a){if(this.c){this.f.b(this.c);this.c=null}if(a)this.a=0},h:function(c){var a=this.j(),b=a>=0;if(b){this.a++;this.b(false);this.c=new Common.G(4,1,a,c);this.f.a(this.c)}else{this.b(true);Diag.a.a(5849676,202,50,"Retries exhausted {0}",{Action:this.e})}return b},a:0,j:function(){return this.a>=this.i().length?-1:this.i()[this.a]},i:function(){if(!this.d){var b=(this.g.a()||"0").split(",");this.d=[];for(var a=0;a<b.length;a++){var c=parseInt(b[a]);if(!isNaN(c))Array.add(this.d,c);else Diag.a.a(5849677,202,15,"Retry interval list contains non-number element {0}",{Action:this.e,Entry:b[a]})}}return this.d}};Common.App.NewAndOpen.Core.c=function(a,b,c,d,e,f,g,h){this.r=Function.createDelegate(this,this.u);this.s=Function.createDelegate(this,this.v);this.k=a;this.n=b;this.l=c;this.m=d;this.q=e;this.j=f;this.o=g;this.p=h};Common.App.NewAndOpen.Core.c.a=function(){return Common.App.NewAndOpen.Core.c.b||(Common.App.NewAndOpen.Core.c.b=Common.App.NewAndOpen.Core.c.c())};Common.App.NewAndOpen.Core.c.c=function(){return new Common.App.NewAndOpen.Core.c(new($$sc.r.$$(Common.cO))(function(){return Common.a.c()}),new($$sc.r.$$(Common.cr))(function(){return Common.a.d}),new($$sc.r.$$(Common.cP))(function(){return Common.a.a()}),new($$sc.r.$$(Common.ed))(function(){return Common.a.a().a().c()}),new($$sc.r.$$(Common.cu))(function(){return Common.a.e()}),function(){return+new Date},new($$sc.r.$$(String))(function(){return Common.a.a().a().f()}),new($$sc.r.$$(Boolean))(function(){return Common.a.bk}))};Common.App.NewAndOpen.Core.c.prototype={k:null,n:null,l:null,m:null,q:null,j:null,o:null,p:null,w:function(){this.h().a(1959943459,2147483648,this.s);if(Common.a.R)this.t();else this.h().d(1169404878,2147483648,this.r,96)},v:function(d,e,f,g,b){var a=b;if(b&&a.MenuItemId){Diag.a.a(5849678,202,50,"Opening new tab {0}",{Id:a.SourceControlId});var c=a.MenuItemId.toString();window.open(c,"_blank")}return 32},u:function(){this.t();return 32},a:function(c,a,f){if(a&&a.m){var d=Common.bI.toString(a.a),b=a.m.getTime(),e=this.j()-b;Diag.a.a(5849679,202,50,"Making request to the WAC server {0}",{Caller:c,RequestStatus:d,ElapsedMs:e,StartTime:b,Notes:f})}else Diag.a.a(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{Caller:c})},t:function(){var f="wdNewAndOpenCt",g="wdPreviousSession",h="wdPreviousCorrelation",e=Common.m.c(document.URL,f);if(!e)return;var a=parseInt(e),b=Common.m.c(document.URL,g),c=Common.m.c(document.URL,h);if(!Common.a.R){Diag.a.a(5849681,202,50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{ClickTimestamp:a,SessionId:b,Correlation:c});return}var d=Common.a.R.getTime();if(!a||a>d)Diag.a.a(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{ClickTimestamp:a,DocumentLoadedTime:d,SessionId:b,Correlation:c});else Diag.a.a(5849683,202,50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{ClickToLoadTime:d-a,ClickTimestamp:a,SessionId:b,Correlation:c})},h:function(){return this.k.a()},d:function(){return this.n.a()},i:function(){return this.l.a()},b:function(){return this.m.a()},f:function(){return this.q.a()},g:function(){return this.j},e:function(){return this.o.a()},c:function(){return this.p.a()}};Common.App.NewAndOpen.Core.l=function(){};Common.App.NewAndOpen.Core.l.a=function(){Common.App.a.a().a(new Common.App.NewAndOpen.Core.g)};Common.App.NewAndOpen.Core.k.registerClass("Common.App.NewAndOpen.Core.k",null,Common.fl);Common.App.NewAndOpen.Core.g.registerClass("Common.App.NewAndOpen.Core.g",null,Common.App.b,Common.Utils.p,Sys.IDisposable);Common.App.NewAndOpen.Core.i.registerClass("Common.App.NewAndOpen.Core.i",Common.App.NewAndOpen.Core.k,Common.be,Common.fl);Common.App.NewAndOpen.Core.d.registerClass("Common.App.NewAndOpen.Core.d",Common.App.NewAndOpen.Core.f.$$(Common.be));Common.App.NewAndOpen.Core.j.registerClass("Common.App.NewAndOpen.Core.j",Common.App.NewAndOpen.Core.k,Common.bu,Common.fl);Common.App.NewAndOpen.Core.a.registerClass("Common.App.NewAndOpen.Core.a",Common.App.NewAndOpen.Core.f.$$(Common.bu));Common.App.NewAndOpen.Core.d.a=null;Common.App.NewAndOpen.Core.b.b=null;Common.App.NewAndOpen.Core.a.c="CurrentDocumentDAVUrl";Common.App.NewAndOpen.Core.a.b="NewDocumentDAVUrl";Common.App.NewAndOpen.Core.a.e="NewFileName";Common.App.NewAndOpen.Core.a.d=null;Common.App.NewAndOpen.Core.c.b=null;Common.App.NewAndOpen.Core.l.a();Type.registerNamespace("Common.App.SessionExpiration");Common.App.SessionExpiration.a=function(d,f){this.e=Function.createDelegate(this,this.k);this.d=Function.createDelegate(this,this.j);this.f=new Common.C;if(d<=0)return;Common.App.SessionExpiration.a.a=d;Common.App.SessionExpiration.a.b=f;var e=new Date,b=d-Common.App.SessionExpiration.a.b*1e3-e.getTime(),a=d-e.getTime();Diag.a.a(17581890,217,50,"Initializing SessionExpirationManager. [MillisecondsToWarning:{0}] [MillisecondsToExpire:{1}] [AccessTokenTtl:{2}] [TimeNow:{3}]",b,a,Common.App.SessionExpiration.a.a,e);if(b<0)b=0;if(a<=0){Diag.a.a(17581891,217,15,"Session has already expired.");a=0}var c=2147483647;a=a<c?a:c;Diag.a.a(17581892,217,50,"Session expires in {0} ms.",a);window.setTimeout(this.d,a);a>0&&window.setTimeout(this.e,b<c?b:c)};Common.App.SessionExpiration.a.prototype={k:function(){this.h()},j:function(){Diag.a.a(17581893,217,50,"Session has expired. Raising session expired event.");this.f.q("SE");this.g()},h:function(){},g:function(){}};Common.App.SessionExpiration.a.registerClass("Common.App.SessionExpiration.a");Common.App.SessionExpiration.a.a=0;Common.App.SessionExpiration.a.b=0;Type.registerNamespace("_Ewa");_Ewa.yK=function(){};_Ewa.yK.a=function(){Common.x.a('.ewr-selection-draghandle{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:5px}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:DRAGDRAGBORDER_ZINDEX;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:default}')};_Ewa.yK.a();Type.registerNamespace("_Ewa");_Ewa.yX=function(){};_Ewa.yX.a=function(){Common.x.a(".ewa-stb-ltr,.ewa-stb-rtl{position:absolute;right:0;bottom:0;left:0;background-color:#f6f6f6;color:#444;height:27px;padding:0;margin:0;-webkit-touch-callout:none;cursor:default}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:absolute;top:0;border:0;height:27px;width:135px;padding:0;margin:0;overflow:hidden}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-ltr .ewa-stb-tabs .tab-active,.ewa-stb-ltr .ewa-stb-tabs .tab-inactive,.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-tabs .tab-active,.ewa-stb-rtl .ewa-stb-tabs .tab-inactive,.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-navareaextra{position:absolute;top:0;border:0;height:27px;width:54px;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:absolute;top:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-ltr .ewa-stb-contentarea{left:136px;right:0}.ewa-stb-rtl .ewa-stb-contentarea{left:0;right:136px}.ewa-stb-tabarea{position:absolute;top:0;height:27px;left:0;right:0}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;list-style:none;left:0;right:0;margin:0;padding:0;overflow:hidden;border:0;white-space:nowrap}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{margin:2px 0 3px 0;background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-right-width:1px;padding:0;height:22px;margin:2px 0 3px 0}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6}.ewa-stb-rtl.ewa-stb-ie8 .ewa-stb-tabs .tab-active{margin-left:1px}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-tabs .cui-img-container{height:14px;top:1px}.ewa-stb-tabs .tab-content-container .clip16x16{display:inline-block}")};_Ewa.yX.a();Type.registerNamespace("_Ewa");_Ewa.qa=function(){_Ewa.qa.initializeBase(this);this.l()};_Ewa.qa.prototype={c:function(){this.i(new Common.App.NewAndOpen.Core.g)}};_Ewa.qa.registerClass("_Ewa.qa",_Ewa.hJ.$$(Sys.IDisposable));Type.registerNamespace("_Ewa");_Ewa.xr=function(){};_Ewa.xr.a=function(){_Ewa.e.a(function(a){a.a().a(_Ewa.wV.$$(Sys.IDisposable),151,new _Ewa.qa)})};_Ewa.xr.a();Type.registerNamespace("_Ewa");_Ewa.yh=function(){};_Ewa.yh.a=function(){_Ewa.e.a(function(a){a.a().a(_Ewa.hF,105,new _Ewa.qW(a))})};_Ewa.qX=function(){};_Ewa.qX.a=function(a,c,d){var b=a.a(1);return a.c("CancelRequest",b,c,d,null,0)};_Ewa.qW=function(a){this.k=Function.createDelegate(this,this.o);this.i=Function.createDelegate(this,this.p);this.l=Function.createDelegate(this,this.q);_Ewa.qW.initializeBase(this);this.d=a;this.a=document.createElement("div");this.a.className="ewr-msg-ctr"};_Ewa.qW.prototype={d:null,e:null,a:null,c:null,g:0,f:false,h:false,b:null,dispose:function(){System.a.a(this.b);this.b=null;this.m();this.d=null;this.e=null;_Ewa.a.g(this.a);this.a=null},j:function(b,a,c){if(a!==this.e){this.e=a;_Ewa.a.a(this.a,false)}b.appendChild(this.a);this.n(c)},n:function(a){if(!this.f&&a)this.b=_Ewa.q.a().a(this.l,3e3,true,false);else if(this.f&&!a){this.e.style.cssText="";_Ewa.a.a(this.a,false);System.a.a(this.b);this.b=null}this.f=a},q:function(){System.a.a(this.b);this.b=null;this.f&&!_Ewa.cF.isInstanceOfType(_Ewa.y.a(this.d).b())&&this.n(false);if(this.f&&this.e){this.h=this.d.n(2);if(!this.h&&this.d.n(8)){var b=_Ewa.y.a(this.d).b();if(_Ewa.cF.isInstanceOfType(b))this.h=this.d.g().o()}var a=new Common.W(this.e);a.b(Common.e.i(this.e)/100,.75);_Ewa.bE.a(_Ewa.K.a()).a(a,"Shared_BasicClass","Shared_BasicClass",null,null);this.g=0;this.o()}},p:function(){_Ewa.qX.a(this.d.c().a(),null,null)},o:function(){System.a.a(this.b);this.b=null;if(this.f&&this.a){var a=[559,560];if(this.g<0||this.g>=a.length)this.g=0;this.m();this.a.innerHTML=String.format(this.h?"<span align='absmiddle'>{0}</span><br><a id='cancelAnchor' style='text-decoration:none;color:white;' href='#' role='link'>{1}</a>":"<span align='absmiddle'>{0}</span>",_Ewa.b.a().a(a[this.g++]),_Ewa.b.a().a(4));if(this.h){this.c=_Ewa.eo.a(_Ewa.a.b(this.a,"cancelAnchor"));this.c.a(this.i)}_Ewa.a.a(this.a,true);this.c&&_Ewa.a.d(this.c.ce,false);this.b=_Ewa.q.a().a(this.k,7e3,true,false)}},m:function(){if(this.c){this.c.b(this.i);System.a.a(this.c);this.c=null}}};_Ewa.qW.registerClass("_Ewa.qW",_Ewa.hF,Sys.IDisposable);_Ewa.yh.a();Type.registerNamespace("_Ewa");_Ewa.yI=function(){};_Ewa.rs=function(){};_Ewa.rs.a=function(b){var a=b.R();return a?a.alt:""};_Ewa.G=function(a){this.b=a||""};_Ewa.G.b=function(){return _Ewa.G.e||(_Ewa.G.e=new _Ewa.G(""))};_Ewa.G.a=function(b){var a=Common.d.a(b||"");return new _Ewa.G(a)};_Ewa.G.c=function(a){return _Ewa.G.a(_Ewa.b.a().a(a))};_Ewa.G.f=function(a){return new _Ewa.G(_Ewa.b.a().b(a))};_Ewa.G.d=function(c){for(var b=[],a=1;a<arguments.length;++a)b[a-1]=arguments[a];return _Ewa.G.g.apply(null,[_Ewa.b.a().c(c)].concat(b))};_Ewa.G.h=function(a,b){return _Ewa.G.g('<a href="{0}">{1}</a>',_Ewa.G.a(b),_Ewa.G.a(a))};_Ewa.G.i=function(a){return new _Ewa.G(a.j)};_Ewa.G.g=function(f){for(var c=[],a=1;a<arguments.length;++a)c[a-1]=arguments[a];for(var d=c.length,e=new Array(d),b=0;b<d;b++)e[b]=(c[b]||_Ewa.G.b()).a();return new _Ewa.G(String.format.apply(null,[f].concat(e)))};_Ewa.G.prototype={b:null,a:function(){return this.b}};_Ewa.ck=function(d,e,f){this.i=Function.createDelegate(this,this.t);this.j=Function.createDelegate(this,this.u);this.n=Function.createDelegate(this,this.s);_Ewa.ck.initializeBase(this);this.a=d;var a=document.createElement("div");a.setAttribute("role","alert");a.setAttribute("aria-live","polite");a.className="ewa-gridReader";e.insertBefore(a,f);this.c=a;this.f=_Ewa.q.a().a(this.n,500,true,false);var b=_Ewa.c.a(d),c=b.a();b.c().e(this.j);b.b().c(this.b);c.f(this.b);c.j(this.b);b.y(this.b);this.a.e().p(this.i)};_Ewa.ck.f=function(){return _Ewa.ck.b||(_Ewa.ck.b=_Ewa.G.f(2))};_Ewa.ck.e=function(){return _Ewa.ck.a||(_Ewa.ck.a=new RegExp("([A-Z])","g"))};_Ewa.ck.d=function(a){a.a().a(_Ewa.eg,61,new _Ewa.ck(a,a.ca(),a.bc()))};_Ewa.ck.h=function(b){var a=b.toString();a=a.replace(_Ewa.ck.e(),"$1 ");return _Ewa.G.a(a)};_Ewa.ck.g=function(b){var a=b.d();switch(_Ewa.a.m(a,"_link","")){case"ext":return _Ewa.G.h(b.b(),a.href);case"int":var c=_Ewa.a.m(a,"_goto","");return _Ewa.G.d(9,_Ewa.G.a(b.b()),_Ewa.G.a(c));default:return _Ewa.G.b()}};_Ewa.ck.c=function(a){switch(a){case 1:return 669;case 2:return 670;case 3:return 671;case 4:return 672;case 5:return 673;case 6:return 674;case 7:return 675;case 8:return 676;case 9:return 677;case 10:return 678;case 11:return 679;case 12:return 680;case 13:return 681;case 14:return 682;case 15:return 683;case 23:return 684;case 24:return 685;case 25:return 686;default:return 687}};_Ewa.ck.prototype={a:null,c:null,f:null,k:function(){return _Ewa.c.a(this.a).h(null)},dispose:function(){if(this.a){var a=_Ewa.c.a(this.a),b=a.a();a.c().c(this.j);a.b().f(this.b);b.g(this.b);b.l(this.b);a.z(this.b);this.a.e().s(this.i)}System.a.a(this.f);this.f=null;this.a=null;this.c=null;_Ewa.eg.prototype.dispose.call(this)},d:function(a){if(a){this.c.setAttribute("aria-live","polite");this.c.innerHTML+=" "}else this.c.removeAttribute("aria-live")},e:function(a){this.m(_Ewa.G.a(a))},h:function(b){var a=this.r(b);this.m(a)},m:function(b){var a=!b?null:b.a();if(a&&!_Ewa.t.a(this.c.innerHTML,a,false))this.c.innerHTML=a},g:function(){!_Ewa.c.a(this.a).n()&&this.f.b()},t:function(b,a){this.h(a.a.a)},s:function(){var a,b,c,d=(c=this.p(b={val:a}),a=b.val,c);this.m(d);this.v(a)},u:function(){var a=this.k();(!a||!a.F()||_Ewa.c.a(this.a).bJ())&&this.f.a()},p:function(d){d.val=null;var b=_Ewa.c.a(this.a).a();switch(b.d()){case 2:var c=b.b().a(),a=c.d,e=!!a.ChartTitle?_Ewa.G.d(23,_Ewa.G.a(a.ChartTitle)):_Ewa.G.b(),f=!!c.w?_Ewa.G.d(24,_Ewa.G.a(c.w)):_Ewa.G.b();return a.DataRangeForDisplay?_Ewa.G.d(25,f,e,_Ewa.G.c(_Ewa.ck.c(a.ChartCategory)),_Ewa.G.a(a.DataRangeForDisplay)):_Ewa.G.d(26,f,e,_Ewa.G.c(_Ewa.ck.c(a.ChartCategory)));case 4:case 8:return _Ewa.G.d(27,_Ewa.G.i(b.b().a()));case 1:d.val=this.k();return this.o(d.val,b.a())}return _Ewa.G.b()},o:function(a,m){if(!a)return _Ewa.G.b();var c=this.a.a(),b=null,d=c.b(_Ewa.dd,55);b=d?d.E():"";var e=c.b(_Ewa.dc,13),f=a.p()?_Ewa.G.c(299):a.h()?_Ewa.G.c(300):_Ewa.G.b(),g=a.G()?_Ewa.ck.g(a):_Ewa.G.a(a.b()),h=a.N()?_Ewa.G.c(302):_Ewa.G.b(),i=!!b?_Ewa.G.a(b):_Ewa.G.b(),j=e?_Ewa.G.a(e.c()):_Ewa.G.b(),k=a.P()?_Ewa.G.c(303):_Ewa.G.b(),l=_Ewa.G.a(_Ewa.rs.a(a));return _Ewa.G.d(8,_Ewa.ck.f(),g,_Ewa.ck.h(m),f,h,i,j,k,l,this.q(a))},q:function(b){var a=_Ewa.c.a(this.a).B(b.a());return a.length>0&&_Ewa.bw.isInstanceOfType(a[0])?_Ewa.G.c(319):_Ewa.G.b()},r:function(a){switch(a){case-1985798686:return _Ewa.G.c(10);case-911352779:return _Ewa.G.c(9);case 237279923:return _Ewa.G.c(11);case-1502853784:return _Ewa.G.f(74);case-111689794:return _Ewa.G.f(71);case-287251124:var b=this;return this.l(590,function(a){return a.n()});case-1925065947:var c=this;return this.l(591,function(a){return a.q()});case 1764140053:var d=this;return this.l(592,function(a){return a.t()})}return null},l:function(c,d){var a=this.k();if(!a)return null;var b=d(a)?6:7;return _Ewa.G.d(b,_Ewa.G.c(c))},v:function(b){var c=this.c.style;if(!b)c.cssText="";else{var d=b.y(c),a=d.a;_Ewa.c.a(this.a).q().u(b);var e=b.z().style;a.backgroundColor=e.backgroundColor;a.top=a.left=a.bottom=a.right=null;c.cssText=e.cssText;d.b()}}};_Ewa.ck.registerClass("_Ewa.ck",_Ewa.eg);_Ewa.G.e=null;_Ewa.ck.a=null;_Ewa.ck.b=null;Type.registerNamespace("_Ewa");_Ewa.yJ=function(){};_Ewa.yJ.a=function(){_Ewa.e.a(_Ewa.ck.d)};_Ewa.yJ.a();Type.registerNamespace("_Ewa");_Ewa.dy=function(c,f,g,h){this.s=Function.createDelegate(this,this.S);this.r=Function.createDelegate(this,this.R);this.n=Function.createDelegate(this,this.H);this.m=Function.createDelegate(this,this.Q);this.v=Function.createDelegate(this,this.P);this.w=Function.createDelegate(this,this.T);this.x=Function.createDelegate(this,this.U);this.y=Function.createDelegate(this,this.V);this.z=Function.createDelegate(this,this.W);this.A=Function.createDelegate(this,this.I);_Ewa.dy.initializeBase(this,[c]);this.i={};this.f=[];this.c=f;this.d=_Ewa.c.a(this.c).a();this.B=g;this.D=h;for(var b=["ewr-selection-draghandle-top","ewr-selection-draghandle-bottom","ewr-selection-draghandle-left","ewr-selection-draghandle-right"],d=b.length,a=0;a<d;++a){var e=b[a];this.M(c,e)}this.c.y(this.A);this.d.p(this.z);this.d.m(this.y);this.d.f(this.x);this.d.J(this.w);this.I(null,null)};_Ewa.dy.prototype={c:null,d:null,B:0,h:null,j:null,g:false,p:0,t:0,u:0,l:null,D:null,f:null,b:null,a:null,e:function(){return _Ewa.c.a(this.c).i()},i:null,q:function(){return this.d.o()},k:function(a){this.d.t(a);return a},dispose:function(){var b=this;Array.forEach(this.f,function(a){Common.c.a().b("msospPointerDown",a,b.v)});Array.clear(this.f);if(this.i)for(var a=1;a<=4;a++)_Ewa.a.g(this.i[a.toString()]);this.i=null;this.a=null;this.b=null;this.j=null;this.h=null;this.l=null;this.c&&this.c.z(this.A);if(this.d){this.d.s(this.z);this.d.r(this.y);this.d.g(this.x);this.d.T(this.w)}_Ewa.dH.prototype.dispose.call(this)},H:function(){if(this.q()!==4)return false;this.e().a(_Ewa.dy.a);this.e().g();if(!this.c.R(this.a)){this.o(this.m,this.n);this.k(-1);return true}if(!this.d.a().f(this.a)&&!this.G(this.a)&&!this.G(this.b)){this.d.e(this.a,this.a.e(),0);this.d.w(this.b.g());this.c.A(-1985798686,2,0,{selectionMode:4,cutCopyPasteFlag:128})}else this.k(-1);!this.h&&this.o(this.m,this.n);return true},S:function(c){if(this.q()===4)this.H(c);else{this.e().a(this.j);this.e().g();if(this.c.R(this.a)&&!this.Y()&&!this.O()){this.d.w(this.b.g());this.X();if(this.g){if(this.a.a>this.b.a){var a=this.a.j();this.a.a=this.a.a-a;this.a.c=this.a.c-a}}else if(this.a.b>this.b.b){var b=this.a.m();this.a.b=this.a.b-b;this.a.d=this.a.d-b}this.d.e(this.a,this.a.e(),0)}}this.o(this.r,this.s);this.h=null;this.k(-1);return true},P:function(a){if(a.b===2&&!a.d){this.a=this.d.a().g();this.b=this.a.g();this.l=this.a;var d=this.N(a);if(d){this.k(4);this.u=d.a-this.b.a;this.t=d.b-this.b.b;this.d.z("move");this.h=this.L(this.D.b(this.b.e()));var g=_Ewa.c.a(this.c);if(this.h&&!this.h.f(this.b)){this.g=this.h.b===this.b.b&&this.h.d===this.b.d;this.j=this.g?[12]:[13];this.k(5);for(var e=g.J(),h=e.length,b=0;b<h;++b){var j=e[b];Common.c.a().a("msospPointerMove",j.g(),this.r)}Common.c.a().a("msospPointerUp",document.documentElement,this.s);this.J(a.get_clientPoint(),a.c,this.g?12:13,true)}else{this.k(4);this.h=null;for(var f=g.J(),i=f.length,c=0;c<i;++c){var k=f[c];Common.c.a().a("msospPointerMove",k.g(),this.m)}Common.c.a().a("msospPointerUp",document.documentElement,this.n);this.p=this.b.i()?1:this.b.l()?2:0;this.J(a.get_clientPoint(),a.c,7,false)}this.C();_Ewa.de.b(this.c,true)}}return true},Q:function(b){var a=this.d.y(b.get_clientPoint(),b.c,4);if(a){this.a=this.F(a);this.e().b(this.a,_Ewa.dy.a);this.e().c(_Ewa.dy.a,null,null);this.C()}return true},R:function(m){var j=m.get_clientPoint(),a=this.d.y(j,m.c,4);if(a){if(this.h.r(a.e())){var b=_Ewa.c.a(this.c),d=b.v(a,1),n=b.l(this.B),k=_Ewa.bT.b(n.e().d(),this.ce.parentNode,j,b.f()),g=false,l=2;if(this.g&&k.b-d.a.b>d.c()/2){g=true;l=1}else if(!this.g&&k.a-d.a.a>d.d()/2)g=true;if(g){var c=b.u(b.O(),l,true);try{c.b(a);c.$$mn();a=c.$$cu().a()}finally{c&&c.dispose()}}this.a=this.K(a);this.d.w(this.a);this.e().b(this.a,this.j);this.e().c(this.j,null,null);this.e().a(_Ewa.dy.a);if(this.q()!==5){for(var e=1;e<=4;e++){var h=this.i[e.toString()];h.parentNode.removeChild(h);this.e().e(this.g?12:13,e).a.appendChild(h)}this.k(5)}}else{this.a=this.F(a);this.e().b(this.a,_Ewa.dy.a);this.e().c(_Ewa.dy.a,null,null);this.e().a(this.j);if(this.q()!==4){for(var f=1;f<=4;f++){var i=this.i[f.toString()];i.parentNode.removeChild(i);this.e().e(7,f).a.appendChild(i)}this.k(4)}}this.C()}return true},V:function(){Sys.UI.DomElement.removeCssClass(this.ce,"selecting")},W:function(){Sys.UI.DomElement.addCssClass(this.ce,"selecting")},U:function(){if(this.c.o()){for(var c=true,e=_Ewa.c.a(this.c).B(this.d.a()),b=e,d=b.length,a=0;a<d;++a){var f=b[a];if(_Ewa.bw.isInstanceOfType(f)){c=false;break}}var g=this;Array.forEach(this.f,function(a){_Ewa.a.a(a,c)})}},T:function(){if(this.q()>=4)if(!this.h){this.e().a(_Ewa.dy.a);this.o(this.m,this.n)}else{this.e().a(this.j);this.o(this.r,this.s)}},M:function(b,c){var a=document.createElement("div");a.className=c;Sys.UI.DomElement.addCssClass(a,"ewr-selection-draghandle");b.appendChild(a);Common.c.a().a("msospPointerDown",a,this.v);Array.add(this.f,a)},F:function(b){var a=this.a.g();if(this.p!==1){a.b=Math.max(b.b-this.t,1);a.d=a.b+this.b.m()-1}if(this.p!==2){a.a=Math.max(b.a-this.u,1);a.c=a.a+this.b.j()-1}return this.E(a)},K:function(b){var a=b.g();if(this.g)a.b=Math.max(b.b-this.t,1);else a.a=Math.max(b.a-this.u,1);a.d=a.b+this.b.m()-1;a.c=a.a+this.b.j()-1;return this.E(a)},C:function(){for(var b=this.a.toString(),a=1;a<=4;a++)this.i[a.toString()].innerText=b},J:function(g,c,m,h){for(var d=_Ewa.a.r(c),a=c===this.f[0]||c===this.f[1],i=a?d.width:d.height,j=(a?-25:-50)+"px",k=a?c===this.f[0]?"top":"bottom":c===this.f[3]||h?"right":"left",l=(a?h?0:g.x-d.x:g.y-d.y)*100/i,b=1;b<=4;b++){var e=document.createElement("div");e.className="ewr-selection-dragtooltip";this.i[b.toString()]=e;this.e().e(m,b).a.appendChild(e);var f=this.i[b.toString()];f.style[k]=j;f.style[a?"left":"top"]=l+"%"}},Y:function(){if(this.g&&this.a.b!==this.h.b||!this.g&&this.a.a!==this.h.a){var a=_Ewa.bf.a(1,1,0,321,0,141,"RearrangeInvalidDest");_Ewa.R.a(this.c).b([a]);return true}return false},X:function(){var a={};if(this.g){a.FirstRow=this.a.a-1;a.FirstColumn=0;a.DeltaColumn=0;a.DeltaRow=this.a.c-this.a.a+1}else{a.FirstRow=0;a.FirstColumn=this.a.b-1;a.DeltaColumn=this.a.d-this.a.b+1;a.DeltaRow=0}a.LastRow=1048575;a.LastColumn=16383;a.SheetName=!this.c.d().b()?this.c.k().e(this.c.k().b().a).d:this.c.d().b().a;var c=_Ewa.s.a(this.b,this.c),b=this,d=function(d,e){return _Ewa.d.R(b.c.c().a(),c,a,d,e,null)};this.c.g().a(new _Ewa.bu(0,d,0),null)},o:function(g,h){this.d.z("default");for(var d=_Ewa.c.a(this.c).J(),e=d.length,b=0;b<e;++b){var f=d[b];Common.c.a().b("msospPointerMove",f.g(),g)}Common.c.a().b("msospPointerUp",document.documentElement,h);for(var a=1;a<=4;a++){var c=this.i[a.toString()];c&&c.parentNode.removeChild(c);this.i[a.toString()]=null}this.j=null;this.p=0},I:function(){var a=this;Array.forEach(this.f,function(b){_Ewa.a.a(b,a.c.o())})},N:function(c){var a=c.c,b=c.get_clientPoint();b.y+=a===this.f[0]?2:a===this.f[1]?-2:0;b.x+=a===this.f[2]?2:a===this.f[3]?-2:0;return this.d.y(b,a,4)},G:function(f){for(var b=_Ewa.c.a(this.c).B(f),a=0,c=b.length;a<c;++a){var d=b[a];if(_Ewa.bw.isInstanceOfType(d)){var e=_Ewa.bf.a(1,0,0,318,0,145,"InsDelCellsPivotTable");_Ewa.R.a(this.c).b([e]);return true}}return false},L:function(a){if(a&&a.r(this.b)&&!a.f(this.b)){if(a.v&&this.b.c===this.b.a&&this.b.a===a.a){this.b=new _Ewa.l(this.b.a,this.b.b,a.c,this.b.d,false,false);this.d.e(this.b,this.b.e(),0);return a}this.g=a.b===this.b.b&&a.d===this.b.d;if(a.a===this.b.a&&a.c===this.b.c||this.g)return a}return null},O:function(){var a=this.a.e().h(this.b);return!a?this.g?this.a.a===this.b.c+1:this.a.b===this.b.d+1:a},E:function(a){var d=_Ewa.c.a(this.c),b=a;if(d.j().h()){var e=d.h(a.e());if(!e){var f=this.l.a!==a.a?1:2,c=d.u(d.O(),f,true);try{c.c(this.l.a<a.a||this.l.b<a.b);c.b(a.e());b=c.$$cu().a()}finally{c&&c.dispose()}}b.d=b.b+a.m()-1;b.c=b.a+a.j()-1}this.l=b;return b}};_Ewa.ry=function(b,c){this.g=Function.createDelegate(this,this.h);this.e=Function.createDelegate(this,this.k);this.f=Function.createDelegate(this,this.l);this.c=Function.createDelegate(this,this.i);this.d=Function.createDelegate(this,this.j);_Ewa.ry.initializeBase(this,[b]);this.a=c;var a=document.createElement("div");a.className="ewr-selection-fillhandle";this.b=a;this.h(null,null);b.appendChild(a);Common.c.a().a("msospPointerDown",this.b,this.d);Common.f.a().a("dblclick",this.b,this.c);this.a.a().p(this.f);this.a.a().m(this.e);this.a.d().y(this.g)};_Ewa.ry.prototype={b:null,a:null,dispose:function(){Common.c.a().b("msospPointerDown",this.b,this.d);Common.f.a().b("dblclick",this.b,this.c);if(this.a.d()){this.a.a().s(this.f);this.a.a().r(this.e);this.a.d().z(this.g)}_Ewa.dH.prototype.dispose.call(this)},k:function(){Sys.UI.DomElement.removeCssClass(this.ce,"selecting")},l:function(){Sys.UI.DomElement.addCssClass(this.ce,"selecting")},j:function(a){if(a.b===2&&!a.d){this.a.a().t(3);this.a.a().w(this.a.a().a())}return false},i:function(){this.a.d().A(1983983164,2,0,null);return true},h:function(){_Ewa.a.a(this.b,this.a.d().o())}};_Ewa.gA=function(a,b){this.b=Function.createDelegate(this,this.c);_Ewa.gA.initializeBase(this,[a,null]);this.a=b;Common.f.a().a("click",a,this.b)};_Ewa.gA.prototype={a:null,c:function(h){var m=h.a,a=this.a.bx(h.get_clientPoint());if(!a)return false;var c=a.b,i=c.g(a.a);if(!i)return false;for(var q=h.f,j=c.d().g(),n=_Ewa.g.r(_Ewa.g.l(c.c(),j),a.a),d=0,k=this.a.h(i.a()),e=0,o=_Ewa.gA.a.length;e<o;++e){var b=_Ewa.gA.a[e];if((b===128||b===64)&&this.a.d().o())continue;var f=k.j(b,"click");if(!f||f.b.style.display==="none")continue;var g=f.b,l=_Ewa.g.l(g,j),p=new Sys.UI.Bounds(l.x,l.y,g.offsetWidth,g.offsetHeight);if(Common.e.b(p,n)){d=b;break}}if(d){k.e(d,m);return true}return false}};_Ewa.rC=function(b){_Ewa.rC.initializeBase(this,[b,null]);var a=document.createElement("div");a.className="ewr-selection-inner-border";b.appendChild(a)};_Ewa.eR=function(a){_Ewa.eR.initializeBase(this,[a,null]);_Ewa.eR.a(a,"ewr-selection-ants-top ewr-ants");_Ewa.eR.a(a,"ewr-selection-ants-right ewr-ants");_Ewa.eR.a(a,"ewr-selection-ants-bottom ewr-ants");_Ewa.eR.a(a,"ewr-selection-ants-left ewr-ants");_Ewa.eR.a(a,"ewr-selection-ants-hc")};_Ewa.eR.a=function(b,c){var a=document.createElement("div");a.className=c;b.appendChild(a)};_Ewa.rD=function(a,b){this.b=Function.createDelegate(this,this.d);_Ewa.rD.initializeBase(this,[false]);this.a=_Ewa.c.a(a);this.c=b;if(this.a.i()){this.a.i().m(this.b);this.a.i().j(false)}a.a().a(Sys.IDisposable,54,this)};_Ewa.rD.prototype={a:null,c:null,dispose:function(){this.a.i().n(this.b);_Ewa.vc.prototype.dispose.call(this)},d:function(g,f){var e=f.a,d=this.a,b=d.i().e(e,f.e),a=b.a,c=b.d;Common.b.b()&&Array.add(c,new _Ewa.gA(a,d));switch(e){case 1:Array.add(b.d,new _Ewa.ry(a,d));!Common.b.e()&&Array.add(c,new _Ewa.dy(a,this.a.d(),b.b,this.c));Array.add(c,new _Ewa.rE(a,d,b.b));break;case 4:Array.add(c,new _Ewa.rC(a));Array.add(c,new _Ewa.rz(a,d,b.b));break;case 5:case 6:Array.add(c,new _Ewa.eR(a));break;case 12:case 13:Array.add(c,new _Ewa.rA(a,e===12))}b.h=true}};_Ewa.yM=function(d,a,e){this.G=Function.createDelegate(this,this.R);this.v=Function.createDelegate(this,this.P);this.u=Function.createDelegate(this,this.O);this.z=Function.createDelegate(this,this.V);this.w=Function.createDelegate(this,this.S);this.j=Function.createDelegate(this,this.Y);this.s=Function.createDelegate(this,this.M);this.y=Function.createDelegate(this,this.U);this.r=Function.createDelegate(this,this.J);this.B=Function.createDelegate(this,this.X);this.x=Function.createDelegate(this,this.T);this.t=Function.createDelegate(this,this.N);this.i=Function.createDelegate(this,this.Q);this.A=Function.createDelegate(this,this.W);_Ewa.yM.initializeBase(this,[d,null]);var b=a.d();this.a=a;this.b=a.a();this.F=d;this.q=e;var c=this.ce.currentStyle.borderTopColor;this.d=new _Ewa.lc(this.C(),c);this.c=new _Ewa.lc(this.C(),c);this.o=b.b().a()&&b.j().NovMode===1;this.d.i(this.A);this.d.h(this.i);this.c.i(this.t);this.c.h(this.i);a.i().h(this.x);a.e().c(this.B);a.c().e(this.r);a.i().d(this.y);a.Y(this.s);b.N(this.j);a.o(this.j);this.b.m(this.w);this.b.p(this.z);a.y(this.u);this.b.x(this.v);this.k=_Ewa.q.a().a(this.G,100,false,false)};_Ewa.yM.prototype={F:null,d:null,c:null,b:null,f:false,h:false,n:false,p:false,E:false,o:false,k:null,g:null,q:0,a:null,dispose:function(){System.a.b([this.d,this.c]);this.d.l(this.A);this.d.k(this.i);this.c.l(this.t);this.c.k(this.i);this.a.i().i(this.x);this.a.e().b(this.B);this.a.c().c(this.r);this.a.i().f(this.y);this.a.ba(this.s);this.a.d().T(this.j);this.a.p(this.j);this.b.r(this.w);this.b.s(this.z);this.a.z(this.u);this.b.v(this.v);System.a.a(this.k);this.k=null;_Ewa.dH.prototype.dispose.call(this)},l:function(){return!this.f&&_Ewa.v.a===3},e:function(){if(this.f){this.d.set_visible(false);this.c.set_visible(false);this.f=false}},m:function(){if(!this.l())return;this.Z();var g=_Ewa.a.r(this.g),b=_Ewa.a.r(this.F),a=new Sys.UI.Bounds(b.x-g.x,b.y-g.y,b.width,b.height),m=this.b.a().e(),n=this.b.a().n(),h=this.b.a(),j=h.i()||h.l(),c,e,d,f;if(h.l()){var k=this.L();c=a.x-18;e=k;d=a.x+b.width;f=k}else if(h.i()){var l=this.K();c=l;e=a.y-18;d=l;f=a.y+b.height}else{e=a.y;f=a.y+b.height;if(this.a.f()){c=a.x+b.width;d=a.x}else{c=a.x;d=a.x+b.width}}var i=5+(j?0:9);this.d.be().left=c-i+"px";this.d.be().top=e-i+"px";this.c.be().left=d-i+"px";this.c.be().top=f-i+"px";this.d.set_visible(this.H(e,c,m,j,g));this.c.set_visible(this.H(f,d,n,j,g));this.f=true},H:function(e,f,g,h,c){var a=3,b=_Ewa.a.r(this.a.l(this.q).g()),d=new Sys.UI.Bounds(b.x-c.x-a,b.y-c.y-a,b.width+2*a,b.height+2*a);return(this.a.j().b(g)===this.q||h)&&Common.e.b(d,new Sys.UI.Point(f,e))},Z:function(){if(!!(this.o^this.n)){this.g=null;var a=this.C();this.d.m(a);this.c.m(a)}},L:function(){return(this.a.e().a().c()+this.a.j().a.b-9+5)/2},K:function(){return(this.a.e().a().d()+this.a.j().a.a-9+5)/2},X:function(){if(this.f){this.e();this.k.b()}},R:function(){this.m()},T:function(){if(this.h&&!this.a.i().l()){this.m();this.h=false}},S:function(){if(this.a.i().l())this.h=true;else this.m();this.p=false},V:function(){this.e();this.p=true},U:function(b,a){if(a.a===this.D()){if(!this.p&&!this.h&&this.E){this.e();this.h=true}else!a.c&&this.e();this.E=a.c}},W:function(){this.I(this.d.V(),false)},N:function(){this.I(this.c.V(),true)},Q:function(b,a){this.b.Q(a)},I:function(a,b){this.b.L(a,b);this.e()},C:function(){if(!this.g){this.n=false;if(this.o){var a=this.a.d().a().b(_Ewa.ds,21);if(a){this.n=true;return this.g=a.c()}}this.g=this.a.C()}return this.g},J:function(){this.e()},O:function(){this.b.b()&&this.e()},M:function(){this.e()},P:function(b,a){if(a.a===3)this.m();else this.e()},Y:function(){if(this.f){this.e();this.m()}}};_Ewa.rz=function(a,b,c){_Ewa.rz.initializeBase(this,[a,b,c])};_Ewa.rz.prototype={D:function(){return 4},l:function(){return this.a.P()&&_Ewa.yM.prototype.l.call(this)}};_Ewa.rE=function(a,b,c){_Ewa.rE.initializeBase(this,[a,b,c])};_Ewa.rE.prototype={D:function(){return 1},l:function(){return!(this.a.P()||this.a.n())&&_Ewa.yM.prototype.l.call(this)}};_Ewa.lc=function(a,b){this.f=Function.createDelegate(this,this.n);this.d=Function.createDelegate(this,this.p);this.e=Function.createDelegate(this,this.q);this.g=Function.createDelegate(this,this.o);_Ewa.lc.initializeBase(this,[document.createElement("div"),null]);this.V().className="ewr-grippie";a.appendChild(this.V());_Ewa.a.a(this.V(),false);this.c=document.createElement("div");Sys.UI.DomElement.addCssClass(this.c,"ewr-grippie-circle");this.c.style.borderColor=b;this.V().appendChild(this.c);Common.c.a().a("msospPointerDown",this.V(),this.g);Common.c.a().a("msospPointerUp",this.V(),this.e);Common.g.a().a("touchend",this.V(),this.e);Common.c.a().a("msospPointerMove",this.V(),this.d);Common.g.a().a("touchmove",this.V(),this.d);Common.f.a().a("click",this.V(),this.f)};_Ewa.lc.prototype={c:null,b:null,a:false,i:function(a){this.bs("GrDrag",a)},l:function(a){this.bt("GrDrag",a)},h:function(a){this.bs("GrContxt",a)},k:function(a){this.bt("GrContxt",a)},dispose:function(){Common.k.f(this.V());_Ewa.tP.prototype.dispose.call(this)},m:function(a){this.V().parentNode.removeChild(this.V());a.appendChild(this.V())},o:function(a){this.a=false;if((_Ewa.v.a=a.b)===3){var b=a.a.rawEvent,c=b.srcElement;if(_Ewa.a.h(this.V(),c)&&_Ewa.a.h(b.currentTarget,c)){this.a=true;this.b=a.get_clientPoint()}}return false},q:function(){this.a=false;return false},p:function(a){if(a.b===3&&this.a&&this.j(a.get_clientPoint())){this.Z("GrDrag",null);this.a=false}return false},n:function(a){a.b===3&&!this.j(a.get_clientPoint())&&this.Z("GrContxt",new _Ewa.iU(a.get_clientPoint(),this.V(),3));return true},j:function(a){return!!this.b&&(Math.abs(a.x-this.b.x)>3||Math.abs(a.y-this.b.y)>3)}};_Ewa.rA=function(a,d){_Ewa.rA.initializeBase(this,[a,null]);var b=document.createElement("div"),c=document.createElement("div");b.className=d?"ewr_selection_rearrangeleft":"ewr_selection_rearrangetop";c.className=d?"ewr_selection_rearrangeright":"ewr_selection_rearrangebottom";a.appendChild(b);a.appendChild(c)};_Ewa.lb=function(a){_Ewa.lb.initializeBase(this);this.h=a;this.l()};_Ewa.lb.a=function(a){a.a().a(_Ewa.wV.$$(Sys.IDisposable),137,new _Ewa.lb(a))};_Ewa.lb.prototype={h:null,c:function(){var a=this;_Ewa.f.cw(_Ewa.m.a(_Ewa.du,this.h.a(),122,this.ch()),function(b){a.i(a.h.a().b(Sys.IDisposable,54)||new _Ewa.rD(a.h,b.a()))},this.ch(),3)}};_Ewa.rC.registerClass("_Ewa.rC",_Ewa.dH);_Ewa.dy.registerClass("_Ewa.dy",_Ewa.rC);_Ewa.ry.registerClass("_Ewa.ry",_Ewa.rC);_Ewa.gA.registerClass("_Ewa.gA",_Ewa.dH);_Ewa.eR.registerClass("_Ewa.eR",_Ewa.dH);_Ewa.rD.registerClass("_Ewa.rD",_Ewa.vc);_Ewa.yM.registerClass("_Ewa.yM",_Ewa.dH);_Ewa.rz.registerClass("_Ewa.rz",_Ewa.yM);_Ewa.rE.registerClass("_Ewa.rE",_Ewa.yM);_Ewa.lc.registerClass("_Ewa.lc",_Ewa.tP);_Ewa.rA.registerClass("_Ewa.rA",_Ewa.dH);_Ewa.lb.registerClass("_Ewa.lb",_Ewa.hJ.$$(Sys.IDisposable));_Ewa.dy.a=[7];_Ewa.gA.a=[1,2,32,256,128,64];Type.registerNamespace("_Ewa");_Ewa.yL=function(){};_Ewa.yL.a=function(){_Ewa.e.a(_Ewa.lb.a)};_Ewa.yL.a();Type.registerNamespace("_Ewa");_Ewa.rU=function(a,b){this.d=Function.createDelegate(this,this.g);this.c=Function.createDelegate(this,this.f);this.e=Function.createDelegate(this,this.h);_Ewa.rU.initializeBase(this,[document.createElement("a"),null]);this.b=b;this.a=_Ewa.gB.a(this.ce,_Ewa.b.a().a(177),1,"ewa-stb-insert-new",_Ewa.b.a().a(178));a.appendChild(this.ce);var c=this;this.ck().a("contextmenu",function(a){_Ewa.n.a(a,true)});this.ck().a("mouseover",this.e);this.ck().a("mouseout",this.e);Common.f.a().a("click",this.ce,this.c);Common.j.a().a("keyup",this.ce,this.d)};_Ewa.rU.prototype={b:null,a:null,dispose:function(){Common.f.a().b("click",this.ce,this.c);Common.j.a().b("keyup",this.ce,this.d);this.a=null;this.b=null;_Ewa.dH.prototype.dispose.call(this)},f:function(a){this.b.A(-1935155518,a.b,0,null);return true},g:function(a){return a.a.keyCode===13||a.a.keyCode===32?this.f(a):false},h:function(a){var b=a.type==="mouseover"||a.type==="focus";_Ewa.g.q(this.a,"ewa-stb-insert-new","ewa-stb-insert-new-hover",b)}};_Ewa.gB=function(b,c){this.y=Function.createDelegate(this,this.ck);this.x=Function.createDelegate(this,this.cj);this.br=Function.createDelegate(this,this.cd);this.P=Function.createDelegate(this,this.ci);this.bb=Function.createDelegate(this,this.bM);this.W=Function.createDelegate(this,this.ct);this.U=Function.createDelegate(this,this.cp);this.T=Function.createDelegate(this,this.co);this.S=Function.createDelegate(this,this.cn);this.R=Function.createDelegate(this,this.cm);this.O=Function.createDelegate(this,this.cg);this.N=Function.createDelegate(this,this.cf);this.f=[];this.i=new Array(6);this.L=new Array(6);_Ewa.gB.initializeBase(this,[c,null]);this.e=b;this.C=b.b();this.J=new _Ewa.dl(this.V(),3,null);Common.b.d()&&Sys.UI.DomElement.addCssClass(this.V(),"ewa-stb-ie8");this.bU();this.bS();this.bV();this.bN(true);this.bM(null,null);var a=this.e.d();a.a(this.N);a.m(this.O);a.n(this.R);a.r(this.S);a.y(this.T);a.z(this.U);a.o(this.W);this.e.y(this.bb);this.e.N(this.P);_Ewa.bo.a(this.e).a(this);this.e.a().a(_Ewa.cu,29,this)};_Ewa.gB.a=function(b,d,e,f,g){b.removeAttribute("Href");b.setAttribute("role","button");b.className="ewa-stb-navbutton";b.title=d;b.tabIndex=0;var c=document.createElement("span");c.className="clip16x16";Sys.UI.DomElement.addCssClass(c,"cui-img-container");c.tabIndex=-1;b.appendChild(c);var a=document.createElement("img");a.src=_Ewa.i.a(e);a.className=f;a.alt=g;a.tabIndex=-1;c.appendChild(a);return a};_Ewa.gB.b=function(d,b,a,c){if(d<a.val){if(b>a.val)a.val--;if(b>c.val)c.val--}else if(d>c.val){if(b<a.val)a.val++;if(b<c.val)c.val++}else if(b<a.val)a.val++};_Ewa.gB.prototype={e:null,C:null,J:null,l:null,w:null,F:null,E:null,u:null,j:false,g:0,h:0,n:6,B:false,z:false,s:function(){return this.V()},M:function(){return this.bi()},bc:function(){return"STB"},o:false,m:null,d:function(a){this.m=a;return a},H:null,I:false,bl:function(){return this.e.Z()?["ewa-stb-last","ewa-stb-next","ewa-stb-prev","ewa-stb-first","ewa-stb-more","ewa-stb-more"]:["ewa-stb-first","ewa-stb-prev","ewa-stb-next","ewa-stb-last","ewa-stb-more","ewa-stb-more"]},p:0,dispose:function(){if(this.e){var a=this.e.d();a.c(this.N);a.p(this.O);a.q(this.R);a.u(this.S);a.D(this.T);a.E(this.U);a.w(this.W);this.e.z(this.bb);this.e.T(this.P)}System.a.b(this.L);this.L=null;if(this.i)for(var b=0;b<this.i.length;b++){var c=_Ewa.a.E(this.i[b],this.V(),false,"a");c&&Common.k.f(c)}System.a.b([this.J,this.u]);this.J=null;this.u=null;this.bf();this.C=null;this.e=null;this.i=null;this.l=null;this.w=null;this.F=null;_Ewa.tP.prototype.dispose.call(this)},G:function(c,a){if(!a){var b=_Ewa.a.E(this.i[0],this.V(),false,"a");_Ewa.a.d(b,false)}return!a},by:function(a){return _Ewa.a.h(this.s(),a)},c:function(a,d,e){if(this.m&&this.m!==a){var c=this.m.e;this.cu(this.m,a,d);var b=!a?d?this.e.d().d()-1:0:a.e-1;if(c!==b){this.ce(c,b,e);this.bX(this.m.a,b)}}},a:function(d){for(var c=this.e.d(),a=0,e=c.d();a<e;a++){var b=c.f(a);b.u()&&d.c(Common.d.a(b.a),b.a,false)}d.g(0)},cm:function(b,a){this.bK(a.a)},co:function(f,c){for(var d=this.e.d().b().e,a=0,e=this.f.length;a<e;a++){var b=this.k(a);if(b.d.innerText===c.b){b.u(c.a);this.q();a===d&&this.r(6);break}}},ct:function(b,a){if(a.b){this.D(false);this.bL(a.a)}else this.bK(a.a)},b:function(b){var a=this.t(b);return a!==-1&&this.g<=a&&a<=this.h?this.f[a].V():null},cq:function(c,a){var b=a.a;a.b===2&&!b.button&&this.bR(c)},cr:function(a){this.o&&this.bq(a.a,false)},cs:function(a){this.o&&this.c(a.a,false,true);this.bk()},bw:function(){return this.e.o()},q:function(){this.F.style.width=this.p.toString()+"px";this.w.style.left=(this.j?0:this.p+135+1).toString()+"px";var c=~_Ewa.g.c(new _Ewa.cd(this.f),this.g,this.f.length-this.g,null,this.br);this.h=Math.max(0,Math.min(c-1,this.f.length-1));this.n=6;for(var a=this.g;a<this.f.length;a++){var b=this.k(a);if(!b)break;if(a<=this.h){var d=b.V();this.n+=d.offsetWidth;b.c.tabIndex=0}else b.c.tabIndex=-1}if(Common.b.c()||Common.b.a())this.n+=(this.h-this.g+1)/2;this.n=Math.min(this.n,this.p);this.F.style.width=this.n.toString()+"px";this.w.style.left=(this.j?this.p-this.n:this.n+135+1).toString()+"px";this.cw()},cw:function(){var b=!!this.g&&this.f.length>=1,a=this.i[4];if(!a)return;_Ewa.a.a(a,b);var c=a.parentNode.parentNode;c.title=a.alt=b?_Ewa.b.a().a(247):"";c.tabIndex=b?0:-1;b=this.h!==this.f.length-1&&this.f.length>=1;a=this.i[5];if(!a)return;_Ewa.a.a(a,b);c=a.parentNode.parentNode;c.title=a.alt=b?_Ewa.b.a().a(249):"";c.tabIndex=b?0:-1},D:function(d){var b=this.e.Z()?this.h:this.g,c=this.e.Z()?this.g:this.h,a=this.bD(b);if(a)a.borderLeftWidth=d?"1px":"0";if(this.g===this.h)return;a=this.bD(c);if(a)a.borderLeftWidth="0"},bv:function(a,b){if(!this.f)this.f=[];if(b===-1)Array.add(this.f,a);else Array.insert(this.f,b,a)},bz:function(d,e){var a=-1,b=null;if(!e){a=this.cb(d.e);if(a!==-1)b=this.A(a)}var c=new _Ewa.dz(this.e,this.l,b,d,this);this.bv(c,a);_Ewa.a.a(c.V(),true)},bq:function(e,a){var b=this.K(e);if(b){this.H=e;this.I=a;var c=b.V(),d=c.offsetLeft,f=!this.j&&a||this.j&&!a;if(f)d+=c.offsetWidth;this.E.style.left=d-4+"px";_Ewa.a.a(this.E,true)}},bF:function(){_Ewa.a.a(this.E,false)},r:function(a){this.D(false);switch(a){case 0:this.bn(0);break;case 1:this.bn(this.g-1);break;case 2:this.bo(this.h+1);break;case 3:this.bo(this.f.length-1);break;case 4:if(this.g&&this.f.length>=1){this.bu(this.g-1);this.bp()}break;case 5:if(this.h!==this.f.length-1&&this.f.length>=1){this.bu(this.h+1);this.bp()}break;case 6:this.bp()}this.D(true)},bu:function(b){var a=this.k(b);a&&a.h()},ca:function(e){if(!e.d)for(var b=this.e.d(),c=0,a=0,f=b.d();a<f;a++){var d=$$as(_Ewa.C,b.f(a));if(d===e)return c;if(!d.d)c++}return-1},bY:function(e){for(var b=this.e.d(),a=e.e+1,d=b.d();a<d;a++){var c=$$as(_Ewa.C,b.f(a));if(!c.d)return c}return null},t:function(c){for(var a=0;a<this.f.length;a++){var b=this.k(a);if(b.a===c)return a}return-1},K:function(b){var a=this.t(b);return this.k(a)},ce:function(b,c,d){var a={};a.a=this.e.h().UserSessionId;a.b=d;a.c=this.z;a.d=b;a.e=c;a.f=this.e.d().d();_Ewa.V.a().a(2,a)},cu:function(d,e,f){var c=$$as(_Ewa.ca,this.e.d()),a;if(!e)a=f?c.P()-1:0;else{var b=e.e;a=d.e<b?b-1:b}c.bg(d,a)},bO:function(a){_Ewa.c.a(this.e).a().z(a)},bR:function(c){if(!this.B){var a=this.V().ownerDocument.body;Common.c.a().a("msospPointerMove",a,this.x);Common.c.a().a("msospPointerUp",a,this.y);Common.g.a().a("touchmove",a,this.x);Common.g.a().a("touchend",a,this.y);this.B=true}this.m=c.a;this.z=false;var b="pointer";Sys.UI.DomElement.addCssClass(this.V(),"ewa-stb-drag");this.V().style.cursor="";this.bO(b)},bk:function(){if(this.B){this.bO("default");var a=this.V().ownerDocument.body;Common.c.a().b("msospPointerMove",a,this.x);Common.c.a().b("msospPointerUp",a,this.y);Common.g.a().b("touchmove",a,this.x);Common.g.a().b("touchend",a,this.y);this.o=this.B=false}this.z=false;this.m=null;this.H=null;Sys.UI.DomElement.removeCssClass(this.V(),"ewa-stb-drag");this.bF()},bX:function(d,e){var a=this.e.c(),b=a?a.a():null,f=this,c=function(a,c){return _Ewa.rX.a(b,d,e,a,c,null)};this.e.g().a(new _Ewa.M(0,c,0),null)},k:function(a){return a>=0&&a<this.f.length?this.f[a]:null},bC:function(b){var a=this.k(b);return a?a.a:null},A:function(b){var a=this.k(b);return a?a.V():null},bD:function(b){var a=this.A(b);return a?a.style:null},cb:function(f){var c=this.e.d(),b=f+1,a=-1,d=this.f?this.f.length:0;while(b<c.d()){var e=$$as(_Ewa.C,c.f(b));if(!e.d){for(a=0;a<d;a++)if(this.bC(a)===e)break;break}b++}return a===-1||a===d?-1:a},bK:function(c){var a=this.K(c);this.l.removeChild(a.V());var b=Array.indexOf(this.f,a);Array.removeAt(this.f,b);this.q();this.r(6)},bL:function(b){var a=this.t(b);if(a===-1){this.bz($$as(_Ewa.C,b),false);a=this.t(b)}this.bE(a,true)},cv:function(a){var c=this.K(a);if(c){var d=Array.indexOf(this.f,c),g=this.ca($$as(_Ewa.C,a));if(d===g)return;this.D(false);var e,f;_Ewa.gB.b(d,g,e={val:this.g},f={val:this.h}),this.g=e.val,this.h=f.val;this.l.removeChild(c.V());Array.removeAt(this.f,d)}var h=this.bY(a),b=this.t(h),i=this.A(b),j=new _Ewa.dz(this.e,this.l,i,$$as(_Ewa.C,a),this);this.bv(j,b);b=this.t(a);this.bE(b,false)},bA:function(){for(var d=this.f?this.f.length:0,e=this.g,f=this.h,a=0;a<d;a++){var b=this.k(a),c=a>=e;if(b){b.Q(c);b.c.tabIndex=c&&a<=f?0:-1}}},bE:function(a,b){if(b&&a<=this.g){this.D(false);this.g++}this.bA();this.q();this.r(6)},bN:function(c){var b=this.e.Z();if(c||this.j!==b){this.j=b;this.V().className=this.j?"ewa-stb-rtl":"ewa-stb-ltr";this.V().dir=this.j?"rtl":"ltr"}for(var a=0;a<this.i.length;a++)this.bP(a)},bU:function(){var a=document.createElement("div");a.className="ewa-stb-navarea";this.V().appendChild(a);this.v(a,0,240,239);this.v(a,1,242,241);this.v(a,2,244,243);this.v(a,3,246,245);this.v(a,4,248,247)},bV:function(){var a=this.w=document.createElement("div");a.className="ewa-stb-navareaextra";this.V().appendChild(a);this.v(a,5,250,249);this.bx()},bP:function(b){var a=this.i[b];if(a)a.className=this.bl()[b]},bS:function(){var a=this.F=document.createElement("div");a.className="ewa-stb-contentarea";this.V().appendChild(a);this.bW(a)},bW:function(b){var a=document.createElement("div");a.className="ewa-stb-tabarea";!this.e.V()&&Sys.UI.DomElement.addCssClass(a,"ewr-grddisableprint");b.appendChild(a);this.l=document.createElement("ul");this.l.className="ewa-stb-tabs";a.appendChild(this.l);this.bT()},bT:function(){var a=document.createElement("div"),b="<div class='clip8x5'>{0}</div>",c=_Ewa.i.e("ewa-stb-reorder-indicator",1,"55_16_N","");a.innerHTML=String.format(b,c);a.className="ewa-stb-sheettabmoveindicator";_Ewa.a.a(a,false);this.E=a;this.l.appendChild(a)},bh:function(){for(var c=this.e.d(),b=0,d=c.d();b<d;b++){var a=$$as(_Ewa.C,c.f(b));if(!a.d){this.bz(a,true);a.i()&&a.g()}}},bf:function(){System.a.b(this.f);this.f=[];this.g=0;this.h=0},v:function(j,a,k,l){var b=document.createElement("a");j.appendChild(b);this.i[a]=_Ewa.gB.a(b,_Ewa.b.a().a(l),0,this.bl()[a],_Ewa.b.a().a(k));if(a===5||a===4){var i=_Ewa.a.E(this.i[a],b,false,"span");i.style.marginTop="10px"}this.bP(a);var c=this.L[a]=this.Y.a(b),g=this;Common.f.a().a("click",b,function(){return g.bI(a)});var h=this;Common.j.a().a("keydown",b,function(b){return b.a.keyCode===13||b.a.keyCode===32?h.bI(a):false});var f=this.bw(),e=this,d=function(b){_Ewa.n.a(b,true);if(f)e.cl(b,a);else e.bJ(b,a)};c.a("mouseover",d);c.a("mouseout",d);c.a("focus",d);c.a("blur",d);f&&c.a("mouseup",d)},bG:function(c){var a=false,b=$get(this.e.m()+"gridDiv");if(b)a=Common.e.b(_Ewa.a.r(b),c.get_clientPoint());return a},bH:function(a){return Common.e.b(_Ewa.a.r(this.V()),a.get_clientPoint())||this.bG(a)},bZ:function(e,f){var b=null,d=e.get_clientPoint(),a=this.g;if(this.bH(e))for(a=this.g;a<=this.h;a++){b=this.k(a);if(b){var c=_Ewa.a.r(b.V());if(!this.j&&d.x<c.x+c.width||this.j&&d.x>c.x)break}}f.val=a>this.h;return b},cj:function(e){var a,b,c,d=(c=this.bZ(e,b={val:a}),a=b.val,c);if(d)this.bq(d.a,a);else this.bF();this.o=true;return true},ck:function(a){if(this.o&&this.bH(a)){this.z=this.bG(a);var b=this.I?null:this.H;this.c(b,this.I,true)}this.bk();return true},bI:function(a){this.r(a);return true},bJ:function(b,c){var a=this.bl()[c],d=b.type==="mouseover"||b.type==="focus";_Ewa.g.q(this.i[c],a,a+"-hover",d)},cl:function(d,b){var c=this.cc(b),a=b===5;if(d.type==="mouseup"){if(a||b===4){!c&&this.c(null,a,true);this.bk()}}else if(this.o){if(!c){var e=this.bC(a?this.h:this.g);this.bq(e,a)}this.r(a?2:1)}else this.bJ(d,b)},cc:function(b){var a=_Ewa.a.I(this.i[b],"a",false);return!!a.title},cf:function(b,a){a.b&&this.bQ(a.b);this.bN(false);this.q();if(a.a){this.bQ(a.a);this.r(6);this.C.o()}},bQ:function(b){var a=this.K(b);a&&a.w()},cg:function(){this.bf()},bp:function(){var b=this.e.d();if(!b.b())return;var a=this.t(b.b());if(a!==-1){var c=this.A(a);if(a<this.g)this.bn(a);else a>this.g&&!this.bm(c)&&this.bo(a)}},bn:function(c){var a=this.e.d();if(!a.d())return;!this.f.length&&this.bh();var b=Math.max(0,Math.min(c,this.f.length-1));this.g=b;this.bA();this.q()},bo:function(e){var b=this.e.d();if(!b.d())return;!this.f.length&&this.bh();var a=Math.max(0,Math.min(e,this.f.length-1)),c=this.A(a);while(this.g<a&&!this.bm(c)){var d=this.k(this.g);d.Q(false);++this.g;this.q()}},bm:function(a){return a.offsetTop<=27&&a.offsetLeft+a.offsetWidth<=this.p&&a.offsetWidth>0},bx:function(){var a=this.e.d();if(!this.e.t()||!a.d()){System.a.a(this.u);this.u=null}else if(!this.u)this.u=new _Ewa.rU(this.w,this.e)},bM:function(){this.Q(!this.C.a());this.p=Math.max(0,this.V().offsetWidth-135-54);this.bf();this.bh();this.bx();this.q();this.r(6)},ci:function(){if(this.bi()){this.p=Math.max(0,this.V().offsetWidth-135-54);this.q();this.r(6)}},cp:function(b,a){this.cv(a.a)},cn:function(b,a){this.bL(a.a)},cd:function(a){return this.bm(a.V())?-1:1}};_Ewa.dz=function(e,f,g,b,d){this.p=Function.createDelegate(this,this.E);this.s=Function.createDelegate(this,this.C);this.t=Function.createDelegate(this,this.D);this.n=Function.createDelegate(this,this.A);this.m=Function.createDelegate(this,this.z);this.o=Function.createDelegate(this,this.B);_Ewa.dz.initializeBase(this,[document.createElement("li"),null]);this.k=new _Ewa.rV(this,e);this.a=b;this.g=d;this.i=d.bw();var a=this.b=document.createElement("span");a.className="tab-content-container";var c=this.d=document.createElement("span");c.className="tab-text";c.dir=b.I()?"rtl":"ltr";this.y();this.V().appendChild(this.c);this.c.appendChild(a);a.appendChild(c);this.a.G()&&this.x(b.I(),b.i());this.w();_Ewa.a.s(a,"button",null,null,null);Common.c.a().a("msospPointerDown",this.V(),this.o);Common.j.a().a("keydown",this.V(),this.m);Common.j.a().a("keypress",this.V(),this.n);this.ba().a("mouseover",this.t);this.ba().a("mouseout",this.s);this.i&&Common.c.a().a("msospPointerUp",this.V(),this.p);this.l=true;this.j=new _Ewa.dl(this.V(),1,null);f.insertBefore(this.V(),g)};_Ewa.dz.c=function(){return _Ewa.dz.a||(_Ewa.dz.a=_Ewa.bv.a("#F6F6F6"))};_Ewa.dz.b=function(e,a){if(a>1||a<-1)return e;var b=e.c,c=e.b,d=e.a;if(a>0){b=b*(1-a)+a*255;c=c*(1-a)+a*255;d=d*(1-a)+a*255}else{b=b*(1+a);c=c*(1+a);d=d*(1+a)}return _Ewa.bF.a(b,c,d)};_Ewa.dz.d=function(a){var b=(a.c*222+a.b*707+a.a*71)/1e3;return b<=128};_Ewa.dz.prototype={i:false,l:false,j:null,d:null,f:null,b:null,e:null,q:false,g:null,k:null,u:function(a){if(this.d)this.d.innerText=a;for(var e=this.a.G()?String.format(_Ewa.b.a().c(12),a):a,c=[this.b,this.c,this.V()],d=c.length,b=0;b<d;++b){var f=c[b];f.setAttribute("aria-label",e)}return a},a:null,c:null,dispose:function(){if(this.l){Common.c.a().b("msospPointerDown",this.V(),this.o);Common.j.a().b("keydown",this.V(),this.m);Common.j.a().b("keypress",this.V(),this.n);this.i&&Common.c.a().b("msospPointerUp",this.V(),this.p);this.l=false}System.a.b([this.k,this.j]);this.k=null;this.j=null;this.g=null;this.c=null;this.b=null;this.d=null;this.f=null;this.a=null;this.e=null;_Ewa.tP.prototype.dispose.call(this)},w:function(){this.u(this.a.a);this.V().className=this.a.i()?"tab-active":"tab-inactive";this.G()},v:function(e,f){var a=this.b.style;if(!a)return;if(!a.paddingLeft||!a.paddingRight||!e)f=true;if(f)a.paddingLeft=a.paddingRight="18px";else{var c=e-4-(this.b.clientWidth-Number.parseInvariant(a.paddingLeft.replace("px",""))-Number.parseInvariant(a.paddingRight.replace("px",""))),b=c/2,d=c-b;if(b!==18)a.paddingLeft=b.toString()+"px";if(d!==18)a.paddingRight=d.toString()+"px"}},h:function(){this.a.g()},z:function(a){a.a.keyCode===13&&this.h();return false},A:function(a){a.a.charCode===32&&this.h();return false},D:function(){this.g.cr(this);!this.g.o&&this.r(true)},C:function(){this.r(false)},B:function(a){this.h();this.i&&this.g.cq(this,a);return!Common.b.e()},E:function(){this.g.cs(this);return true},G:function(){var a=this.a.B;this.e=!a?_Ewa.dz.c():_Ewa.bv.a(a);this.q=_Ewa.dz.d(this.e);this.r(false)},r:function(e){var a=this.a.i(),c=!!this.a.B,b=_Ewa.bv.b(a?_Ewa.bF.e():this.e);if(a)if(c){this.b.style.background="";this.F()}else this.b.style.backgroundColor=b;else{this.b.style.background="";this.b.style.filter="";this.b.style.backgroundColor=b}if(a){this.d.className="tab-active-text";if(this.f)this.f.firstChild.className="ewa-stb-lock-active"}else{this.d.className=this.q?"light":"dark";if(this.f)this.f.firstChild.className="ewa-stb-lock"}if(a||e){var d=this.V().clientWidth;this.d.style.fontWeight="bold";this.v(d,false)}else{this.d.style.fontWeight="";this.v(0,true)}},F:function(){var b=this.b.style,c=_Ewa.bv.b(_Ewa.dz.b(this.e,1)),d=_Ewa.bv.b(_Ewa.dz.b(this.e,.5)),a="";if(Common.b.i())a="-webkit-";else if(Common.b.c())a="-moz-";else if(Common.b.a()){a="-ms-";if(!Common.b.k()){b.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",c,d);return}}else if(Common.b.z())a="-o-";b.background=String.format("{0}linear-gradient({1}, {2})",a,c,d)},y:function(){this.c=document.createElement("a");this.c.removeAttribute("Href");this.c.className="tab-anchor-text";this.c.tabIndex=-1},x:function(c,d){var a=this.f=document.createElement("span");a.className="clip16x16";Sys.UI.DomElement.addCssClass(a,"cui-img-container");if(c)this.b.appendChild(a);else this.b.insertBefore(a,this.d);var b=document.createElement("img");b.src=_Ewa.i.a(0);b.className=d?"ewa-stb-lock-active":"ewa-stb-lock";b.alt=_Ewa.b.a().a(251);b.tabIndex=-1;a.appendChild(b)}};_Ewa.rV=function(a,b){this.e=Function.createDelegate(this,this.i);this.c=Function.createDelegate(this,this.g);this.d=Function.createDelegate(this,this.h);_Ewa.rV.initializeBase(this,[a.V(),null]);this.a=a;this.b=b;Common.f.a().a("dblclick",a.V(),this.d);Common.D.a().a(a.V(),this.c);this.ck().a("keydown",this.e)};_Ewa.rV.prototype={b:null,a:null,dispose:function(){if(this.a){Common.f.a().b("dblclick",this.a.V(),this.d);Common.D.a().c(this.a.V(),this.c);this.a=null}this.b=null;_Ewa.dH.prototype.dispose.call(this)},i:function(a){if(a.keyCode===121&&a.shiftKey){this.f(new Sys.UI.Point(0,0),1,this.a.c);_Ewa.n.a(a,true)}},h:function(a){if(!this.b.o())return false;this.j(false,a.b);return true},g:function(a){return this.f(a.get_clientPoint(),a.b,a.c)},f:function(c,d,e){this.a.h();var b=new _Ewa.T(-1075099431,d,this.b.o()?2:1,30,null),a;return!_Ewa.bY.a(a=this.b.e().b(b,{ClientPoint:c,Sheet:this.a.a,Target:e},null))&&(a.b!==6||a.a())},j:function(a,b){this.b.A(817296323,b,a?19:0,null)}};_Ewa.lj=function(a){_Ewa.lj.initializeBase(this);this.h=a;this.l()};_Ewa.lj.a=function(a){a.a().a(_Ewa.wV.$$(_Ewa.cu),30,new _Ewa.lj(a))};_Ewa.lj.prototype={h:null,c:function(){var b=this.h.m();if(this.h.h().Options&1)return;var a=$get(b+"m_sheetTabBar");if(!a)return;this.i(this.h.a().b(_Ewa.cu,29)||new _Ewa.gB(this.h,a))}};_Ewa.rX=function(){};_Ewa.rX.a=function(b,c,d,e,f,g){var a=b.a(17);a.sheetName=c;a.newSheetIndex=d;return _Ewa.d.a(b,"ReorderSheets",a,e,f,g,0)};_Ewa.rU.registerClass("_Ewa.rU",_Ewa.dH);_Ewa.gB.registerClass("_Ewa.gB",_Ewa.tP,_Ewa.cu,Sys.IDisposable,_Ewa.wG);_Ewa.dz.registerClass("_Ewa.dz",_Ewa.tP);_Ewa.rV.registerClass("_Ewa.rV",_Ewa.dH);_Ewa.lj.registerClass("_Ewa.lj",_Ewa.hJ.$$(_Ewa.cu));_Ewa.dz.a=null;Type.registerNamespace("_Ewa");_Ewa.yY=function(){};_Ewa.yY.a=function(){_Ewa.e.a(_Ewa.lj.a)};_Ewa.yY.a();Type.registerNamespace("_Ewa");_Ewa.zm=function(a){this.h=Function.createDelegate(this,this.o);this.j=Function.createDelegate(this,this.p);this.i=Function.createDelegate(this,this.l);this.f=[];_Ewa.zm.initializeBase(this,[false]);this.g=a;var f=a.b();f.b(this.i);f.d(this.j);a.d().d().i(this.h);a.d().k().i(this.h);for(var e=a.J(),h=e.length,b=0;b<h;++b){var i=e[b],c=i.$$ge();while(c.$$mn()){var j=c.$$cu(),d=j.$$ge();while(d.$$mn()){var g=d.$$cu(),k=a.b().g(g.b());this.l(this,new _Ewa.ix(new _Ewa.gL(k,g.b()),null))}}}};_Ewa.zm.prototype={a:function(){return this.f},g:null,dispose:function(){if(this.g){this.g.b().a(this.i);this.g.b().e(this.j);this.g.d().d().h(this.h);this.g.d().k().h(this.h)}this.g=null;this.f=null;_Ewa.bP.prototype.dispose.call(this)},n:function(a){return this.k(a)},k:function(d){for(var a=0,c=this.f.length;a<c;a++){var b=this.f[a];if(d.h(b))return b}return null},l:function(k,b){var f,c=b.a.a,d=false;if(!c.c||!(c.a&1)||!(f=this.g.l(b.a.a.b.Information.BlockCachePosition.PaneType).r(b.a.b)))return;var g=this.m(c.b),h=f.a();if(h)for(var a=this.f.length-1;a>=0;a--)if(h.r(this.f[a].n())){Array.removeAt(this.f,a);d=true}for(var e=0,i=g.length;e<i;e++){Array.add(this.f,_Ewa.eW.a(g[e]));d=true}if(d){var j=this.g.H().r(b.a.b);this.cf("lrc",new _Ewa.jU(j),null)}},p:function(){var b;if(!this.f.length||!(b=this.g.k()))return;for(var a=this.f.length-1;a>=0;a--)!b.h(this.f[a])&&Array.removeAt(this.f,a)},o:function(){this.f=[]}};_Ewa.ss=function(a,b){_Ewa.ss.initializeBase(this,[a]);b.a(_Ewa.du,56,this)};_Ewa.ss.prototype={d:function(a){this.cg("lrc",a)},e:function(a){this.ci("lrc",a)},b:function(a){return this.q(this.n(a))},c:function(a){return!!this.k(a)},m:function(a){return a.Autofilters},q:function(a){if(!a)return null;var b=new _Ewa.ip(a.a,a.b,a.c,a.d,null,null,null,a.y,a.v);b.t=a.t;for(var d=0,e=this.f.length;d<e;d++){var c=this.f[d];if(c.y===a.y&&c!==a){b.z(c);if(c.t)b.t=true}}return b}};_Ewa.zn=function(){};_Ewa.zn.a=function(){_Ewa.e.a(function(a){a.a().a(_Ewa.wV.$$(_Ewa.du),122,new _Ewa.st(a))})};_Ewa.st=function(a){_Ewa.st.initializeBase(this);this.h=a;this.l()};_Ewa.st.prototype={j:null,h:null,c:function(){this.i(this.j||(this.j=new _Ewa.ss(_Ewa.c.a(this.h),this.h.a())))}};_Ewa.zm.registerClass("_Ewa.zm",_Ewa.bP);_Ewa.ss.registerClass("_Ewa.ss",_Ewa.zm,_Ewa.du);_Ewa.st.registerClass("_Ewa.st",_Ewa.hJ.$$(_Ewa.du));_Ewa.zn.a();Type.registerNamespace("_Ewa");_Ewa.tq=function(){};_Ewa.tq.a=function(){_Ewa.e.a(_Ewa.hU.a)};_Ewa.hU=function(a){_Ewa.hU.initializeBase(this);this.h=a;this.l()};_Ewa.hU.a=function(a){a.a().a(_Ewa.wV.$$(_Ewa.dq),145,new _Ewa.hU(a))};_Ewa.hU.prototype={h:null,c:function(){this.i(this.h.a().b(_Ewa.dq,14)||new _Ewa.lQ(this.h))}};_Ewa.lQ=function(a){_Ewa.lQ.initializeBase(this,[a.p(),a]);this.e=_Ewa.bp.f(171);a.a().a(_Ewa.dq,14,this)};_Ewa.lQ.prototype={e:null,h:function(){return["TM","RM","BB","GHC","BE","PTP","CTP","SCP","GK","FMP","SK","STB","SB","BM"]},a:function(a){this.d.q()&65536&&_Ewa.tr.prototype.a.call(this,a)},k:function(a){var c=this.o(a.target);if(a.keyCode===13&&c>=0&&this.f()[c].bc()==="RM")_Ewa.n.a(a,true);else if(_Ewa.t.a(this.e,_Ewa.bp.c(a,0),false)){var b=_Ewa.bz.b(this.d);if(b&&b.M()){_Ewa.n.a(a,true);b.G(true,false)}}},m:function(){},l:function(){}};_Ewa.hU.registerClass("_Ewa.hU",_Ewa.hJ.$$(_Ewa.dq));_Ewa.lQ.registerClass("_Ewa.lQ",_Ewa.tr);_Ewa.tq.a();Type.registerNamespace("_Ewa");_Ewa.hV=function(a){_Ewa.hV.initializeBase(this);this.h=a;this.l()};_Ewa.hV.a=function(a){a.a().a(_Ewa.wV.$$(Sys.IDisposable),36,new _Ewa.hV(a))};_Ewa.hV.prototype={h:null,c:function(){var a=this.h.h();this.i(this.h.a().b(Sys.IDisposable,35)||new _Ewa.lS(this.h,a.AccessTokenValidTo,a.AccessTokenExpirationPromptSeconds))}};_Ewa.lS=function(a,b,c){this.c=new _Ewa.bP(false);_Ewa.lS.initializeBase(this,[b,c]);this.b=a};_Ewa.lS.prototype={b:null,a:function(a){this.c.cg("SessionExpired",a)},m:function(){return _Ewa.b.a().a(556)},n:function(){var a=new Date(Common.App.SessionExpiration.a.a),b=a.format(this.b.h().ShortTimeFormat);return String.format(_Ewa.b.a().c(46),b)},dispose:function(){System.a.a(this.c);this.b=null},h:function(){this.b.t()&&this.i(false)},g:function(){this.i(true);this.c.cf("SessionExpired",null,null)},l:function(){var b=this.b.j(),a=new Sys.StringBuilder,c=_Ewa.c.a(this.b).a().u();a.append(this.b.t()?b.FullDocumentInfo.HostEditUrl:b.FullDocumentInfo.HostViewUrl);c&&_Ewa.L.a(a,"activeCell",c);return a.toString()},i:function(a){var e=_Ewa.y.a(this.b),b=e.a().a();b.NPAnu=this.l();b.NPAnum="ntw";var c=this.b.i().E();a&&c&&c.e()&&c.b().MessageId===401&&this.b.i().E().g();var d=this,f=function(){var c=_Ewa.bf.a(a?1:12,1,0,0,0,a?402:401,a?"AccessTokenExpiredWarning":"AccessTokenExpiringWarning");c.Description=a?d.m():d.n();e.a().d([c]);b.PUOAudna="cw50"};_Ewa.R.a(this.b).a(new _Ewa.bB("cw8",3,f))}};_Ewa.hV.registerClass("_Ewa.hV",_Ewa.hJ.$$(Sys.IDisposable));_Ewa.lS.registerClass("_Ewa.lS",Common.App.SessionExpiration.a,Common.dW,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.ts=function(){};_Ewa.ts.a=function(){_Ewa.e.a(_Ewa.hV.a)};_Ewa.ts.a();var WacAnimation={};function WacCurve(b,a,c,e,d,f){this.ID=b;this.type=a;this.x1=c;this.y1=e;this.x2=d;this.y2=f}var WacCurveType={Instant:0,Hold:1,Linear:2,CubicBezier:3},WacCurveID={Instant:0,Hold:1,Linear:2,ShotgunToPillowLanding:3,EaseIn:4,EaseOut:5,EaseInOut:6,Exponential:7},g_AnimationCurves=new Array(8);g_AnimationCurves[WacCurveID.Instant]=new WacCurve(WacCurveID.Instant,WacCurveType.Instant,0,0,0,0);g_AnimationCurves[WacCurveID.Hold]=new WacCurve(WacCurveID.Hold,WacCurveType.Hold,0,0,0,0);g_AnimationCurves[WacCurveID.Linear]=new WacCurve(WacCurveID.Linear,WacCurveType.Linear,0,0,0,0);g_AnimationCurves[WacCurveID.ShotgunToPillowLanding]=new WacCurve(WacCurveID.ShotgunToPillowLanding,WacCurveType.CubicBezier,0,0,0,1);g_AnimationCurves[WacCurveID.EaseIn]=new WacCurve(WacCurveID.EaseIn,WacCurveType.CubicBezier,.83,0,1,1);g_AnimationCurves[WacCurveID.EaseOut]=new WacCurve(WacCurveID.EaseOut,WacCurveType.CubicBezier,0,0,.58,1);g_AnimationCurves[WacCurveID.EaseInOut]=new WacCurve(WacCurveID.EaseInOut,WacCurveType.CubicBezier,.42,0,.58,1);g_AnimationCurves[WacCurveID.Exponential]=new WacCurve(WacCurveID.Exponential,WacCurveType.CubicBezier,.1,.25,.75,.9);function WacIntWrapper(b,a){this.value=b;this.contextId=a}WacKeyFrame.prototype={type:0,curveID:0,startTime:new WacIntWrapper(0,null),endTime:new WacIntWrapper(0,null),startValue:new WacIntWrapper(0,null),endValue:new WacIntWrapper(0,null),relativeTo:0,operationType:0};function WacKeyFrame(h,g,a,c,b,d,f,e){this.type=h;this.curveID=g;this.startTime=a==null||a.value==undefined?new WacIntWrapper(a,null):a;this.endTime=c==null||c.value==undefined?new WacIntWrapper(c,null):c;this.startValue=b==null||b.value==undefined?new WacIntWrapper(b,null):b;this.endValue=d==null||d.value==undefined?new WacIntWrapper(d,null):d;this.relativeTo=f;this.operationType=e}var g_numAnimationAttributes=8;WacAnimation.Attribute={PositionX:1,PositionY:2,Height:3,Width:4,Opacity:5,ScrollTop:6,ScrollLeft:7,RotateZ:8};var AnimRelativeTo={Initial:0,Final:1,Absolute:2},WacKeyframeType={Mult:0,Add:1};WacAnimation.ContextID={};var g_AnimationContextVariables=new Array(0);WacAnimation.ContextVariableManager=WacAnimation_ContextVariableManager;function WacAnimation_ContextVariableManager(){}WacAnimation_ContextVariableManager.prototype={};WacAnimation_ContextVariableManager.prototype.SetContextVariable=function(b,a){var c=WacAnimation.ContextID[b];g_AnimationContextVariables[c].value=a};function WacAnim(a,b){this.ID=a;this.keyFrames=b}WacAnimation.ID={BASIC_QUICKESTSHOW:0,BASIC_QUICKMOVE:1,BASIC_QUICKSIZE:2,BASIC_QUICKFADE:3,BASIC_QUICKSHOW:4,BASIC_QUICKHIDE:5,BASIC_MOVE:6,BASIC_SIZE:7,BASIC_FADE:8,BASIC_SHOW:9,BASIC_HIDE:10,BASIC_SCROLL:11,BASIC_SLOWMOVE:12,BASIC_SLOWSIZE:13,BASIC_SLOWFADE:14,BASIC_SLOWSHOW:15,TAB_MOVE:16,TAB_SLIDEINFADEINBOTTOM:17,BASIC_INSTANTFADE:18,DELAY_SHOW:19,DELAY_MOVE:20,WAC_RIBBONMOVE:21,WAC_RIBBONSHOW:22,WAC_RIBBONHIDE:23};var g_WacAnimations=new Array(24);g_WacAnimations[WacAnimation.ID.BASIC_QUICKESTSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKESTSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKMOVE]=new WacAnim(WacAnimation.ID.BASIC_QUICKMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKSIZE]=new WacAnim(WacAnimation.ID.BASIC_QUICKSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKFADE]=new WacAnim(WacAnimation.ID.BASIC_QUICKFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKSHOW]=new WacAnim(WacAnimation.ID.BASIC_QUICKSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_QUICKHIDE]=new WacAnim(WacAnimation.ID.BASIC_QUICKHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_MOVE]=new WacAnim(WacAnimation.ID.BASIC_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SIZE]=new WacAnim(WacAnimation.ID.BASIC_SIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_FADE]=new WacAnim(WacAnimation.ID.BASIC_FADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SHOW]=new WacAnim(WacAnimation.ID.BASIC_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_HIDE]=new WacAnim(WacAnimation.ID.BASIC_HIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SCROLL]=new WacAnim(WacAnimation.ID.BASIC_SCROLL,[new WacKeyFrame(WacAnimation.Attribute.ScrollTop,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.ScrollLeft,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWMOVE]=new WacAnim(WacAnimation.ID.BASIC_SLOWMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWSIZE]=new WacAnim(WacAnimation.ID.BASIC_SLOWSIZE,[new WacKeyFrame(WacAnimation.Attribute.Height,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.Width,WacCurveID.ShotgunToPillowLanding,0,750,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWFADE]=new WacAnim(WacAnimation.ID.BASIC_SLOWFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.BASIC_SLOWSHOW]=new WacAnim(WacAnimation.ID.BASIC_SLOWSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,750,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.TAB_MOVE]=new WacAnim(WacAnimation.ID.TAB_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,433,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM]=new WacAnim(WacAnimation.ID.TAB_SLIDEINFADEINBOTTOM,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,50,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,0,null,40,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,100,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.BASIC_INSTANTFADE]=new WacAnim(WacAnimation.ID.BASIC_INSTANTFADE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Instant,0,0,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.DELAY_SHOW]=new WacAnim(WacAnimation.ID.DELAY_SHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.ShotgunToPillowLanding,201,500,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.DELAY_MOVE]=new WacAnim(WacAnimation.ID.DELAY_MOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.Linear,0,200,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,201,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONMOVE]=new WacAnim(WacAnimation.ID.WAC_RIBBONMOVE,[new WacKeyFrame(WacAnimation.Attribute.PositionX,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add),new WacKeyFrame(WacAnimation.Attribute.PositionY,WacCurveID.ShotgunToPillowLanding,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Add)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONSHOW]=new WacAnim(WacAnimation.ID.WAC_RIBBONSHOW,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,0,null,0,AnimRelativeTo.Absolute,WacKeyframeType.Mult),new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,1,AnimRelativeTo.Final,WacKeyframeType.Mult)]);g_WacAnimations[WacAnimation.ID.WAC_RIBBONHIDE]=new WacAnim(WacAnimation.ID.WAC_RIBBONHIDE,[new WacKeyFrame(WacAnimation.Attribute.Opacity,WacCurveID.Linear,0,267,null,0,AnimRelativeTo.Final,WacKeyframeType.Mult)]);var g_WacAnimationEngine=null,g_WacAnimationLogging=window.location.search.indexOf("AnimationLogging=1")!=-1,g_WacAnimationThrottleFPS=0,g_WacAnimationThrottleNumInstance=3;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,16)}}();WacAnimation.State=WacAnimation_State;WacAnimation.Object=WacAnimation_Object;function WacAnimationEngine(){this.AnimationQueue=new Array(0);this.sharedTimer=null;this.sharedCancelTimer=null;this.resetInterval=5e3;this.sharedTimerRefs=0;this.conflictTable=new Array(0);this.currentAnimationIndex=-1;this.temporaryIDGenerator=0}WacAnimationEngine.prototype={AnimationQueue:new Array(0),sharedTimer:null,sharedCancelTimer:null,resetInterval:5e3,sharedTimerRefs:0,conflictTable:new Array(0),currentAnimationIndex:-1,temporaryIDGenerator:0};WacAnimationEngine.prototype.LocalStepper=function(){g_WacAnimationEngine.StepAllAnimations()};WacAnimationEngine.prototype.LocalStopper=function(){g_WacAnimationEngine.StepAllAnimations();g_WacAnimationEngine.StopEngine()};WacAnimationEngine.prototype.StartEngine=function(){if(this.sharedTimer!=null||this.sharedCancelTimer!=null||this.sharedTimerRefs!=0)return;this.sharedTimer=window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper);g_WacAnimationEngine.StartCancelTimer();this.sharedTimerRefs=0;g_WacAnimationTelemetry.Start()};WacAnimationEngine.prototype.StopEngine=function(){g_WacAnimationTelemetry.Stop();g_WacAnimationEngine.StopCancelTimer();if(this.sharedTimer!=null)this.sharedTimer=null;this.sharedTimerRefs=0;this.conflictTable=new Array(0);this.AnimationQueue=new Array(0)};WacAnimationEngine.prototype.StartAnimation=function(a){this.AnimationQueue[this.sharedTimerRefs++]=a};WacAnimationEngine.prototype.StopAnimation=function(b){for(var a=0;a<this.AnimationQueue.length;a++)if(this.AnimationQueue[a]==b){this.RemoveTemporaryIds(b);this.AnimationQueue[a]=null}};WacAnimationEngine.prototype.StepAllAnimations=function(){var c=false,b=null;g_WacAnimationEngine.StopCancelTimer();for(var a=0;a<this.AnimationQueue.length;a++)if(this.AnimationQueue[a]!=null){if(IsNullOrUndef(b))b=this.AnimationQueue[a].currentTime;this.currentAnimationIndex=a;this.AnimationQueue[a].StepAnimation();c=true}this.currentAnimationIndex=-1;c&&!IsNullOrUndef(b)&&g_WacAnimationTelemetry.AddPerfData(new Date-b);if(c){g_WacAnimationEngine.StartCancelTimer();window.requestAnimationFrame(WacAnimationEngine.prototype.LocalStepper)}else this.StopEngine()};WacAnimationEngine.prototype.CheckForConflictingAnimations=function(d,h){if(d.id==null||d.id==""){var k="tempAnimID_"+String(this.temporaryIDGenerator);this.temporaryIDGenerator++;d.id=k}var i=d.id+"_"+String(h),c=this.conflictTable[i];if(IsNullOrUndef(c)||c==this.currentAnimationIndex||this.AnimationQueue[c]==null)this.conflictTable[i]=this.currentAnimationIndex;else{var a=this.AnimationQueue[c];a.curveID.SetAttribute(h,null);if(a.finishFunc!=null){var b=this.AnimationQueue[this.currentAnimationIndex],e=a.finishFunc,g=a.extraData,f=b.finishFunc,j=b.extraData;b.finishFunc=f==null?function(){e(g)}:function(){e(g);f(j)};b.extraData=null;a.finishFunc=null}}};WacAnimationEngine.prototype.RemoveTemporaryIds=function(b){var a;if(IsArrayCheck(b.element))for(var d=b.element.length,c=0;c<d;c++){a=b.element[c];if(a.id.indexOf("tempAnimID_")==0)a.id==null}else{a=b.element;if(a.id.indexOf("tempAnimID_")==0)a.id==null}};WacAnimationEngine.prototype.StopCancelTimer=function(){if(this.sharedCancelTimer!=null){window.clearTimeout(this.sharedCancelTimer);this.sharedCancelTimer=null}};WacAnimationEngine.prototype.StartCancelTimer=function(){this.sharedCancelTimer=window.setTimeout(WacAnimationEngine.prototype.LocalStopper,this.resetInterval)};var g_WacRadix=10;function WacAnimation_State(){this.Index=0;this.Data=new Array(0);this.AnimateRight=false}WacAnimation_State.prototype={Index:0,Data:new Array(0),AnimateRight:false};WacAnimation_State.prototype.SetAttribute=function(a,b){var c=this.GetDataIndex(a);if(c==-1){var d=this.Data.length;this.Index+=a*Math.pow(g_WacRadix,d);this.Data[d]=b}else this.Data[c]=b};WacAnimation_State.prototype.GetAttribute=function(b){var a=this.GetDataIndex(b);return a==-1?null:this.Data[a]};WacAnimation_State.prototype.GetDataIndex=function(c){var b=0,a=this.Index;while(a!=0){var d=a%g_WacRadix;if(d==c)return b;a=Math.floor(a/g_WacRadix);b++}return-1};WacAnimation_State.prototype.SetAnimateRight=function(a){this.AnimateRight=a};WacAnimation_Object.prototype={animationID:-1,delay:0,element:null,finalState:null,finishFunc:null,extraData:null,arrAnimationUnits:null,idxAnimUnit:0,cachedContextVariables:null};function WacAnimation_Object(a,f,e,b,c,d){this.Initialize(a,f,e,b,c,d)}WacAnimation_Object.prototype.Initialize=function(a,f,e,b,c,d){this.animationID=a;this.delay=f;this.element=e;this.finalState=b;this.finishFunc=c;this.extraData=d;this.arrAnimationUnits=new Array(0);this.idxAnimUnit=0;this.cachedContextVariables=g_AnimationContextVariables};WacAnimation_Object.prototype.GetIntWrapperValue=function(a){return a.contextId==null?a.value:this.cachedContextVariables[a.contextId].value};WacAnimation_Object.prototype.RunAnimation=function(){if(this.animationID!=-1&&this.element!=null){this.GenerateAnimationUnits();for(var b=this.arrAnimationUnits.length,a=0;a<b;a++)this.arrAnimationUnits[a].StartAnimation()}};WacAnimation_Object.prototype.AdvanceToFinalState=function(g,d){for(var c=new WacAnimation_State,j=d.keyFrames.length,b=0;b<j;b++){var e=d.keyFrames[b];c.SetAttribute(e.type,this.GetFinalValue(e,g))}for(var i=g_numAnimationAttributes,f=IsArrayCheck(this.element)?this.element[g]:this.element,a=1;a<=i;a++){var h=c.GetAttribute(a);if(h!=null){var k=new WacAnimationUnit(f,0,0,null,null,this.finalState.AnimateRight);k.SetStyle(a,f,h)}}};WacAnimation_Object.prototype.GenerateAnimationUnits=function(){for(var i=g_WacAnimations[this.animationID],e=null,j=i.keyFrames.length,c=null,h=0;h<j;h++){var a=i.keyFrames[h],f=this.FindMatchingAnimationUnit(a),d,g;if(f!=null){f.startValue.SetAttribute(a.type,this.GetIntWrapperValue(a.startValue));f.curveID.SetAttribute(a.type,a.curveID);if(IsArrayCheck(this.element)){g=this.element.length;for(d=0;d<g;d++){c=this.GetFinalValue(a,d);if(IsNullOrUndef(c)){f.curveID.SetAttribute(a.type,null);break}else f.targetValue[d].SetAttribute(a.type,c)}}else{c=this.GetFinalValue(a,-1);if(IsNullOrUndef(c))f.curveID.SetAttribute(a.type,null);else f.targetValue.SetAttribute(a.type,c)}}else{var b=new WacAnimationUnit(this.element,this.GetIntWrapperValue(a.startTime)+this.delay,this.GetIntWrapperValue(a.endTime)-this.GetIntWrapperValue(a.startTime),null,null,this.finalState.AnimateRight);b.startValue.SetAttribute(a.type,this.GetIntWrapperValue(a.startValue));b.curveID.SetAttribute(a.type,a.curveID);if(IsArrayCheck(this.element)){g=this.element.length;for(d=0;d<g;d++){if(b.targetValue==null)b.targetValue=new Array(this.element.length);if(b.targetValue[d]==null)b.targetValue[d]=new WacAnimation_State;c=this.GetFinalValue(a,d);if(IsNullOrUndef(c)){b.curveID.SetAttribute(a.type,null);break}else b.targetValue[d].SetAttribute(a.type,c)}}else{if(b.targetValue==null)b.targetValue=new WacAnimation_State;c=this.GetFinalValue(a,-1);if(IsNullOrUndef(c))b.curveID.SetAttribute(a.type,null);else b.targetValue.SetAttribute(a.type,c)}if(e==null||e.delay+e.duration<=b.delay+b.duration)e=b;this.arrAnimationUnits[this.idxAnimUnit++]=b}}if(e!=null){e.finishFunc=this.finishFunc;e.extraData=this.extraData}};WacAnimation_Object.prototype.FindMatchingAnimationUnit=function(b){for(var d=this.arrAnimationUnits.length,c=0;c<d;c++){var a=this.arrAnimationUnits[c];if(a.delay==this.GetIntWrapperValue(b.startTime)+this.delay&&a.duration==this.GetIntWrapperValue(b.endTime)-this.GetIntWrapperValue(b.startTime))return a}return null};WacAnimation_Object.prototype.GetFinalValue=function(a,e){var b=null;if(!IsNullOrUndef(this.GetIntWrapperValue(a.endValue)))switch(a.relativeTo){case 0:var g=IsArrayCheck(this.element)?this.element[e]:this.element,d=this.GetIntWrapperValue(a.startValue)==null?GetCurrentAttributeCssValue(g,a.type,this.finalState.AnimateRight):this.GetIntWrapperValue(a.startValue);b=a.operationType==0?this.GetIntWrapperValue(a.endValue)*d:this.GetIntWrapperValue(a.endValue)+d;break;case 1:var f=IsArrayCheck(this.element)?this.finalState[e]:this.finalState,c=f.GetAttribute(a.type);if(!IsNullOrUndef(c))b=a.operationType==0?this.GetIntWrapperValue(a.endValue)*c:this.GetIntWrapperValue(a.endValue)+c;break;case 2:b=this.GetIntWrapperValue(a.endValue)}return b};WacAnimationUnit.prototype={element:null,delay:0,duration:0,startValue:null,perElementStartValue:null,targetValue:null,curveID:null,finishFunc:null,extraData:null,startTime:null,fIsExecuting:false,animateRight:false,relativePosition:false};function WacAnimationUnit(e,f,d,b,c,a){this.Initialize(e,f,d,b,c,a)}WacAnimationUnit.prototype.Initialize=function(e,f,d,b,c,a){this.element=e;this.delay=f;this.duration=d;this.finishFunc=b;this.extraData=c;this.startValue=new WacAnimation_State;this.perElementStartValue=null;this.targetValue=null;this.curveID=new WacAnimation_State;this.startTime=null;this.fIsExecuting=false;this.animateRight=a;this.relativePosition=false};WacAnimationUnit.prototype.StartAnimation=function(){if(g_WacAnimationEngine==null)g_WacAnimationEngine=new WacAnimationEngine;g_WacAnimationEngine.sharedTimer==null&&g_WacAnimationEngine.StartEngine();if(this.element.style.position=="relative")this.relativePosition=true;this.startTime=new Date;this.currentTime=new Date;g_WacAnimationEngine.StartAnimation(this)};WacAnimationUnit.prototype.StopAnimation=function(){g_WacAnimationEngine.StopAnimation(this)};WacAnimationUnit.prototype.StepAnimation=function(){this.currentTime=new Date;var f=Number(this.currentTime)-Number(this.startTime);if(f<this.delay)return;f-=this.delay;for(var j=true,k=!this.fIsExecuting,m=g_numAnimationAttributes,a=1;a<=m;a++){var l=this.curveID.GetAttribute(a);if(IsNullOrUndef(l))continue;var i=this.PositionFunction(f,this.duration,l),b,d,e,g,h;if(IsArrayCheck(this.element))for(var n=this.element.length,c=0;c<n;c++){g=this.element[c];b=this.startValue.GetAttribute(a);h=this.targetValue[c];d=h.GetAttribute(a);if(IsNullOrUndef(b)){if(this.perElementStartValue==null)this.perElementStartValue=new Array(this.element.length);if(IsNullOrUndef(this.perElementStartValue[c]))this.perElementStartValue[c]=new WacAnimation_State;b=this.perElementStartValue[c].GetAttribute(a);if(IsNullOrUndef(b)){b=GetCurrentAttributeCssValue(g,a,this.animateRight,this.relativePosition);this.perElementStartValue[c].SetAttribute(a,b)}}e=b+i*(d-b);if(f>=this.duration||i>1)e=d;else j=false;k&&g_WacAnimationEngine.CheckForConflictingAnimations(g,a);this.SetStyle(a,g,e)}else{g=this.element;b=this.startValue.GetAttribute(a);h=this.targetValue;d=h.GetAttribute(a);if(IsNullOrUndef(b)){b=GetCurrentAttributeCssValue(this.element,a,this.animateRight,this.relativePosition);this.startValue.SetAttribute(a,b)}e=b+i*(d-b);if(f>=this.duration||i>1)e=d;else j=false;k&&g_WacAnimationEngine.CheckForConflictingAnimations(this.element,a);this.SetStyle(a,this.element,e)}}this.fIsExecuting=true;if(j){this.StopAnimation();if(this.finishFunc!=null){g_WacAnimationTelemetry.LogData("calling fnishfunc");this.finishFunc(this.extraData)}}};WacAnimationUnit.prototype.PositionFunction=function(c,d,e){var a=0,b=g_AnimationCurves[e];switch(b.type){case 0:a=1;break;case 1:a=c<d?0:1;break;case 2:a=c/d;break;case 3:a=CalculateBezier(b.x1,b.y1,b.x2,b.y2,c/d)}return a};WacAnimationUnit.prototype.SetStyle=function(c,a,b){g_WacAnimationTelemetry.elementIds[a.id]=true;switch(c){case 1:this.StyleLeftSetter(a,b);break;case 2:this.StyleTopSetter(a,b);break;case 3:this.StyleHeightSetter(a,b);break;case 4:this.StyleWidthSetter(a,b);break;case 5:this.StyleOpacitySetter(a,b);break;case 6:this.StyleScrollTopSetter(a,b);break;case 7:this.StyleScrollLeftSetter(a,b);break;case 8:this.StyleRotateZSetter(a,b)}};WacAnimationUnit.prototype.StyleLeftSetter=function(b,a){if(this.animateRight)if(this.relativePosition)b.style.marginRight=String(a)+"px";else b.style.right=String(a)+"px";else if(this.relativePosition)b.style.marginLeft=String(a)+"px";else b.style.left=String(a)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+b.id+", "+(this.animateRight?"right":"left")+": "+String(a)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleTopSetter=function(a,b){if(this.relativePosition)a.style.marginTop=String(b)+"px";else a.style.top=String(b)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+a.id+", top: "+String(a.style.top)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleHeightSetter=function(a,b){a.style.height=String(b)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+a.id+", height: "+String(a.style.height)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleWidthSetter=function(a,b){a.style.width=String(b)+"px";g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+a.id+", width: "+String(a.style.width)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleOpacitySetter=function(b,a){SetCssOpacity(b,a);g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+b.id+", opacity: "+String(a)+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleScrollTopSetter=function(b,a){b.scrollTop=a;g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+b.id+", scrollTop: "+a+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleScrollLeftSetter=function(b,a){b.scrollLeft=a;g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+b.id+", scrollLeft: "+a+", timestamp: "+String(Number(new Date)))};WacAnimationUnit.prototype.StyleRotateZSetter=function(b,a){SetCssRotation(b,a);g_WacAnimationLogging&&g_WacAnimationTelemetry.LogData("element: "+b.id+", rotateZ: "+a+", timestamp: "+String(Number(new Date)))};WacAnimationTelemetry.prototype={perfData:null,logData:null,animationStatsLength:5,animationStats:null,animationStatsIndex:0,perfDataIndex:0,logDataIndex:0,animationIndex:0,startTime:null,duration:null,numUnits:0,elementIds:null,avgSessionFps:-1,countSessionFps:0,minSessionFps:-1,maxSessionFps:-1};function WacAnimationTelemetry(){this.perfData=new Array(0);this.logData=new Array(0);this.animationStats=[];this.animationStatsIndex=0;this.perfDataIndex=0;this.logDataIndex=0;this.animationIndex=0;this.startTime=null;this.duration=null;this.numUnits=0;this.elementIds={};this.avgSessionFps=-1;this.countSessionFps=0;this.minSessionFps=-1;this.maxSessionFps=-1}WacAnimationTelemetry.prototype.Start=function(){this.startTime=new Date;this.perfDataIndex=0;this.logDataIndex=0;this.elementIds={}};WacAnimationTelemetry.prototype.Stop=function(){this.duration=Number(new Date)-Number(this.startTime);this.numUnits=g_WacAnimationEngine.sharedTimerRefs;this.CalculateAndShowStatistics();this.perfDataIndex=0;this.logDataIndex=0};WacAnimationTelemetry.prototype.AddPerfData=function(a){this.perfData[this.perfDataIndex++]=a};WacAnimationTelemetry.prototype.LogData=function(a){this.logData[this.logDataIndex++]=a};WacAnimationTelemetry.prototype.CalculateStatistics=function(){var c=0,n=Number.MAX_VALUE,m=Number.MIN_VALUE,f=0,d=0,l="",k="",o=new Date,i="",g=this.duration;if(IsNullOrUndef(g))g=Number(o)-Number(this.startTime);if(g_WacAnimationLogging&&this.logDataIndex>0)for(var p=this.logDataIndex,a=0;a<p;a++){if(a!=0)l+="<br/>";l+=this.logData[a]}if(this.perfDataIndex>0){var e=this.perfDataIndex;for(a=0;a<e;a++){if(this.perfData[a]<n)n=this.perfData[a];if(this.perfData[a]>m)m=this.perfData[a];f+=this.perfData[a];if(a!=0)k+=", ";k+=this.perfData[a]}if(e>1)f/=e-1;f=Math.round(f*100)/100;for(a=0;a<e;a++){var h=this.perfData[a]-f;h=h*h;d+=h}if(e>1)d/=e-1;d=Math.sqrt(d);d=Math.round(d*100)/100;c=this.perfDataIndex/g*1e3;c=Math.round(c)}for(var q in this.elementIds){i+=q;i+=","}if(this.minSessionFps==-1||c<this.minSessionFps)this.minSessionFps=c;if(this.maxSessionFps==-1||c>this.maxSessionFps)this.maxSessionFps=c;if(this.countSessionFps==0){this.countSessionFps++;this.avgSessionFps=c}else{var j=this.avgSessionFps*this.countSessionFps;j=j+c;this.countSessionFps++;this.avgSessionFps=j/this.countSessionFps}var b=new Array(12);b[0]=g;b[1]=c;b[2]=n;b[3]=m;b[4]=f;b[5]=d;b[6]=k;b[7]=l;b[8]=this.numUnits;b[9]=Number(this.startTime);b[10]=Number(o);b[11]=i;return b};WacAnimationTelemetry.prototype.CalculateAndShowStatistics=function(){var a=this.CalculateStatistics();g_LastAnimationData=a;this.StoreAnimationStats(a)};WacAnimationTelemetry.prototype.StoreAnimationStats=function(a){this.animationStats[this.animationStatsIndex]=a;this.animationStatsIndex++;this.animationStatsIndex=this.animationStatsIndex%this.animationStatsLength};WacAnimationTelemetry.prototype.GetRecentAnimationStats=function(){for(var d=[],c=0,b=g_WacAnimationTelemetry.animationStatsIndex;b<g_WacAnimationTelemetry.animationStatsLength;b++)if(g_WacAnimationTelemetry.animationStats[b]!=null){d[c]=g_WacAnimationTelemetry.animationStats[b];c++}for(var a=0;a<g_WacAnimationTelemetry.animationStatsIndex;a++)if(g_WacAnimationTelemetry.animationStats[a]!=null){d[c]=g_WacAnimationTelemetry.animationStats[a];c++}return d};WacAnimationTelemetry.prototype.GetAnimationSqmStats=function(){var a=[];if(g_WacAnimationTelemetry.avgSessionFps<0)a[0]=0;else a[0]=g_WacAnimationTelemetry.avgSessionFps;if(g_WacAnimationTelemetry.minSessionFps<0)a[1]=0;else a[1]=g_WacAnimationTelemetry.minSessionFps;if(g_WacAnimationTelemetry.maxSessionFps<0)a[2]=0;else a[2]=g_WacAnimationTelemetry.maxSessionFps;return a};var g_WacAnimationTelemetry=new WacAnimationTelemetry,g_LastAnimationData=null;WacAnimation.Telemetry=g_WacAnimationTelemetry;function GetCurrentAttributeCssValue(a,e,d,c){if(IsNullOrUndef(c))c=a.style.position=="relative";var b=0;switch(e){case 1:if(d)b=parseInt(c?a.style.marginRight.replace("px",""):a.style.right.replace("px",""));else b=parseInt(c?a.style.marginLeft.replace("px",""):a.style.left.replace("px",""));break;case 2:b=parseInt(c?a.style.marginTop.replace("px",""):a.style.top.replace("px",""));break;case 3:b=parseInt(a.style.height.replace("px",""));break;case 4:b=parseInt(a.style.width.replace("px",""));break;case 5:b=GetCssOpacity(a);break;case 6:b=parseInt(a.scrollTop);break;case 7:b=parseInt(a.scrollLeft);break;case 8:b=GetCssRotation(a)}return b}function Bezier1(a){return a*a*a}function Bezier2(a){return 3*a*a*(1-a)}function Bezier3(a){return 3*a*(1-a)*(1-a)}function Bezier4(a){return(1-a)*(1-a)*(1-a)}function CalculateBezier(d,b,e,c,a){return 0*Bezier4(a)+b*Bezier3(a)+c*Bezier2(a)+1*Bezier1(a)}function IsArrayCheck(a){return typeof a=="object"&&a instanceof Array}function IsNullOrUndef(a){return a==null||a==undefined}function SetCssOpacity(b,a){if(document.body.style.opacity!=null)b.style.opacity=a;else b.style.filter=a==1?"":"alpha(opacity="+String(a*100)+")"}function GetCssOpacity(c){if(document.body.style.opacity!=null){var b=c.style.opacity;return b!=null&&b!=""?parseFloat(b):1}else{var a=c.style.filter;return a!=null&&a!=""?parseInt(a.replace("alpha(opacity=","").replace(")",""))/100:1}}function SetCssRotation(b,c){var a="rotate("+c+"deg)";if(document.body.style.msTransform!=null)b.style.msTransform=a;else if(document.body.style.webkitTransform!=null)b.style.webkitTransform=a;else if(document.body.style.mozTransform!=null)b.style.mozTransform=a;else if(document.body.style.oTransform!=null)b.style.oTransform=a;else if(document.body.style.transform!=null)b.style.transform=a}function GetCssRotation(b){var a;if(document.body.style.msTransform!=null)a=b.style.msTransform;else if(document.body.style.webkitTransform!=null)a=b.style.webkitTransform;else if(document.body.style.mozTransform!=null)a=b.style.mozTransform;else if(document.body.style.oTransform!=null)a=b.style.oTransform;else if(document.body.style.transform!=null)a=b.style.transform;if(!a)return 0;a=a.replace("rotate(","");a=a.replace("deg)","");return parseFloat(a)}Type.registerNamespace("_Ewa");_Ewa.tF=function(){};_Ewa.tF.a=function(){_Ewa.K.a().a(_Ewa.ep,129,new _Ewa.ml)};_Ewa.ml=function(){_Ewa.ml.initializeBase(this)};_Ewa.ml.prototype={dispose:function(){Common.l.h()&&Common.l.g()},a:function(a,b,c,d,e){!!b&&Common.l.b(a.a,b);Common.l.a(a,d,e);!!c&&Common.l.e(a.a,c)}};_Ewa.ml.registerClass("_Ewa.ml",_Ewa.ep,Sys.IDisposable);_Ewa.tF.a()