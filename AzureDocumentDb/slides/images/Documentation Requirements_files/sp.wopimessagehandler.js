function ULSudL(){var o=new Object;o.ULSTeamName="Microsoft SharePoint Foundation";o.ULSFileName="SP.WOPIMessageHandler.js";return o;}
Type.registerNamespace("SP.WOPIMessageHandler");SP.WOPIMessageHandler.LogLevel=function(){};SP.WOPIMessageHandler.LogLevel.prototype={verbose:0,info:1,warning:2,error:3};SP.WOPIMessageHandler.LogLevel.registerEnum("SP.WOPIMessageHandler.LogLevel",false);SP.WOPIMessageHandler.CrossDocumentMessage=function(a){ULSudL:;this.MessageId=a;this.SendTime=0;this.Values={}};SP.WOPIMessageHandler.AFrameworkApplication=function(){};SP.WOPIMessageHandler.WindowEventManager=function(){};SP.WOPIMessageHandler.WindowEventManager.prototype={addHandler:function(a,b){ULSudL:;var d=this;$addHandler(window.self,a,function(c){ULSudL:;var a=new SP.WOPIMessageHandler.WindowEventArgs;a.origin=c.rawEvent.origin;a.data=c.rawEvent.data;a.source=c.rawEvent.source;b(a)})},removeHandler:function(){}};SP.WOPIMessageHandler.WindowEventArgs=function(){ULSudL:;SP.WOPIMessageHandler.WindowEventArgs.initializeBase(this)};SP.WOPIMessageHandler.WindowEventArgs.prototype={origin:null,data:null,source:null};SP.WOPIMessageHandler.EventHandlerArgs=function(){};SP.WOPIMessageHandler.EventNames=function(){};SP.WOPIMessageHandler.BrowserUtils=function(){};SP.WOPIMessageHandler.BrowserUtils.get_isInternetExplorer8=function(){ULSudL:;return Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version===8};SP.WOPIMessageHandler.DomUtils=function(){};SP.WOPIMessageHandler.DomUtils.isFieldNullOrUndefined=function(b,a){ULSudL:;return SP.ScriptUtility.isNullOrUndefined(b[a])};SP.WOPIMessageHandler.ScriptUtils=function(){};SP.WOPIMessageHandler.ScriptUtils.isNullOrUndefined=function(a){ULSudL:;return SP.ScriptUtility.isNullOrUndefined(a)};SP.WOPIMessageHandler.UrlUtils=function(){};SP.WOPIMessageHandler.UrlUtils.getOrigin=function(a){ULSudL:;var b="",c=a.indexOf("://");if(c>0){var d=a.indexOf("/",c+3);if(d>0)b=a.substring(0,d);else b=a}return b};SP.WOPIMessageHandler.Debug=function(){};SP.WOPIMessageHandler.Debug.log=function(c){ULSudL:;for(var b=[],a=3;a<arguments.length;++a)b[a-3]=arguments[a];if(b.length>0)c=String.format.apply(null,[c].concat(b))};SP.WOPIMessageHandler.Debug.assert=function(){};SP.WOPIMessageHandler.Debug.assertStringTag=function(){};SP.WOPIMessageHandler.ADebugOptionsTab=function(){};SP.WOPIMessageHandler.ADebugOptionsTab.getOptionValue=function(){ULSudL:;return false};SP.WOPIMessageHandler.LogCategory=function(){};SP.WOPIMessageHandler.WOPIMessageHandler=function(){};SP.WOPIMessageHandler.WOPIMessageHandler.initialize=function(e,a,d,f,b){ULSudL:;if(!a||!a.length)throw Error.argumentNull("wopiServerUrl");SP.WOPIMessageHandler.AFrameworkApplication.theWindowEventManager=new SP.WOPIMessageHandler.WindowEventManager;var h=$get("WebApplicationFrame");if(!h)throw Error.invalidOperation();SP.WOPIMessageHandler.WOPIMessageHandler.$0=new SP.WOPIMessageHandler.CrossDocumentMessenger(h.contentWindow,a);SP.WOPIMessageHandler.WOPIMessageHandler.$0.enable();if(b&&b.length>0)for(var j=b.split(";"),g=j,i=g.length,c=0;c<i;++c){var k=g[c];SP.WOPIMessageHandler.WOPIMessageHandler.$0.addAllowedOrigin(k)}else{SP.WOPIMessageHandler.WOPIMessageHandler.$0.addAllowedOrigin(a);SP.DebugLogger.Write("WOPIHostTelemetry",1,"WOPIMessageHandler allowedOrigins is empty for wopiServerUrl:"+a)}SP.WOPIMessageHandler.WOPIMessageHandler.$0.addAllowedReceivingMessage("App_LoadingStatus");SP.WOPIMessageHandler.WOPIMessageHandler.$0.registerCallback("App_LoadingStatus",SP.WOPIMessageHandler.WOPIMessageHandler.$S);SP.WOPIMessageHandler.WOPIMessageHandler.$0.addAllowedReceivingMessage("File_Rename");SP.WOPIMessageHandler.WOPIMessageHandler.$0.registerCallback("File_Rename",SP.WOPIMessageHandler.WOPIMessageHandler.$T);if(Flighting.VariantConfiguration.IsExpFeatureClientEnabled(26)){if(!e||!e.length)throw Error.argumentNull("webUrl");if(!d||!d.length)throw Error.argumentNull("listID");if(f<=0)throw Error.argumentOutOfRange("listItemID");SP.WOPIMessageHandler.WOPIMessageHandler.$G=e;SP.WOPIMessageHandler.WOPIMessageHandler.$E=d;SP.WOPIMessageHandler.WOPIMessageHandler.$F=f;SP.WOPIMessageHandler.WOPIMessageHandler.$0.addAllowedReceivingMessage("UI_Sharing");SP.WOPIMessageHandler.WOPIMessageHandler.$0.registerCallback("UI_Sharing",SP.WOPIMessageHandler.WOPIMessageHandler.$U)}SP.WOPIMessageHandler.WOPIMessageHandler.$0.addAllowedReceivingMessage("UI_ToggleYammerPanel");SP.WOPIMessageHandler.WOPIMessageHandler.$0.registerCallback("UI_ToggleYammerPanel",SP.WOPIMessageHandler.WOPIMessageHandler.$V)};SP.WOPIMessageHandler.WOPIMessageHandler.$U=function(a){ULSudL:;a.MessageId==="UI_Sharing"&&SP.WOPIMessageHandler.WOPIMessageHandler.$M()};SP.WOPIMessageHandler.WOPIMessageHandler.$M=function(){ULSudL:;EnsureScriptFunc("sharing.js","DisplayUnthemedSharingDialog",function(){ULSudL:;window.self.DisplayUnthemedSharingDialog(SP.WOPIMessageHandler.WOPIMessageHandler.$G,SP.WOPIMessageHandler.WOPIMessageHandler.$E,SP.WOPIMessageHandler.WOPIMessageHandler.$F.toString())})};SP.WOPIMessageHandler.WOPIMessageHandler.$S=function(k){ULSudL:;var b=new SP.WOPIMessageHandler.CrossDocumentMessage("Host_PerfTiming"),e=window.self.WOPIPerf_UserClick;if(!SP.WOPIMessageHandler.ScriptUtils.isNullOrUndefined(e))b.Values.Click=e;var a="UserClick: "+SP.WOPIMessageHandler.WOPIMessageHandler.$9(e),c=null,f=null,d=-1,g=window.self.performance;if(!SP.ScriptHelpers.isNullOrUndefined(g)){var i=g.timing;if(!SP.ScriptHelpers.isNullOrUndefined(i)){c=i.fetchStart;if(!SP.ScriptHelpers.isNullOrUndefined(c))b.Values.FetchStart=c;f=i.responseEnd}var j=g.navigation;if(!SP.ScriptHelpers.isNullOrUndefined(j)){d=j.redirectCount;if(!SP.ScriptHelpers.isNullOrUndefined(d))b.Values.RedirectCount=d}}a+=", DeltaFetchStart: "+SP.WOPIMessageHandler.WOPIMessageHandler.$J(c);a+=", DeltaResponseEnd: "+SP.WOPIMessageHandler.WOPIMessageHandler.$J(f);var h=window.self.WOPIPerf_WACIframeCreate;if(!SP.WOPIMessageHandler.ScriptUtils.isNullOrUndefined(h))b.Values.Iframe=h;a+=", DeltaIframeCreate: "+SP.WOPIMessageHandler.WOPIMessageHandler.$9(h);a+=", RedirectCount: "+d;var l=window.self.WOPIPerf_WACTarget;a+=", WacTarget: "+l;SP.DebugLogger.Write("WOPIHostTelemetry",1,a);var m=k.Values.m_Source,n=k.Values.m_Origin;SP.WOPIMessageHandler.WOPIMessageHandler.$0.send(b,m,n);UploadFileXferTelemetry("WACDownload",SP.WOPIMessageHandler.WOPIMessageHandler.$9(c),SP.WOPIMessageHandler.WOPIMessageHandler.$9(f),0)};SP.WOPIMessageHandler.WOPIMessageHandler.$J=function(b){ULSudL:;var a=SP.WOPIMessageHandler.WOPIMessageHandler.$9(b);return a===-1?"<none>":a.toString()};SP.WOPIMessageHandler.WOPIMessageHandler.$9=function(b){ULSudL:;if(SP.ScriptHelpers.isNullOrUndefined(b))return-1;var a=b;if(SP.WOPIMessageHandler.WOPIMessageHandler.$D===-1)SP.WOPIMessageHandler.WOPIMessageHandler.$D=a;var c=a-SP.WOPIMessageHandler.WOPIMessageHandler.$D;return c};SP.WOPIMessageHandler.WOPIMessageHandler.$T=function(a){ULSudL:;if(a.MessageId==="File_Rename"){var b=a.Values.NewName;window.document.title=b}};SP.WOPIMessageHandler.WOPIMessageHandler.$V=function(b){ULSudL:;if(b.MessageId!=="UI_ToggleYammerPanel")return;var a=window.self.yp;a&&a.toggle()};SP.WOPIMessageHandler.CrossDocumentMessageId=function(){};SP.WOPIMessageHandler.CrossDocumentMessageFields=function(){};SP.WOPIMessageHandler.CrossDocumentMessenger=function(b,a){ULSudL:;this.$$d_$R_0=Function.createDelegate(this,this.$R_0);this.$4_0=false;this.$3_0=null;this.$6_0=null;this.$2_0=null;this.$5_0=null;this.$8_0=b;this.$B_0=a;this.$7_0=false;this.$1_0=null;SP.WOPIMessageHandler.CrossDocumentMessenger.$I++};SP.WOPIMessageHandler.CrossDocumentMessenger.$L=function(){ULSudL:;return true};SP.WOPIMessageHandler.CrossDocumentMessenger.$K=function(){ULSudL:;return true};SP.WOPIMessageHandler.CrossDocumentMessenger.isPostMessageSupported=function(a){ULSudL:;return SP.WOPIMessageHandler.ScriptUtils.isNullOrUndefined(a)?!SP.WOPIMessageHandler.DomUtils.isFieldNullOrUndefined(window,"postMessage"):!SP.WOPIMessageHandler.DomUtils.isFieldNullOrUndefined(a,"postMessage")};SP.WOPIMessageHandler.CrossDocumentMessenger.sendMessageToElement=function(b,c,d){ULSudL:;var a=b;if(a&&!SP.WOPIMessageHandler.CrossDocumentMessenger.isPostMessageSupported(a))a=a.contentWindow;SP.WOPIMessageHandler.CrossDocumentMessenger.sendMessage(a,c,d)};SP.WOPIMessageHandler.CrossDocumentMessenger.sendMessage=function(b,c,d){ULSudL:;if(SP.WOPIMessageHandler.AFrameworkApplication.isCrossDocumentMessengerDisabled){SP.WOPIMessageHandler.Debug.assertStringTag(false,"Cross-document message is disabled by config setting.",840289);return false}var a=b;if(!a||!SP.WOPIMessageHandler.CrossDocumentMessenger.isPostMessageSupported(a)){SP.WOPIMessageHandler.Debug.assertStringTag(false,"Browser does not support postMessage",840290);throw Error.create("Browser does not support postMessage");}try{a.postMessage(c,d);return true}catch(e){SP.WOPIMessageHandler.Debug.assertStringTag(false,"postMessage failed: "+e.message,840291)}SP.WOPIMessageHandler.Debug.log("After post message failed: ","CrossDocumentMessenger",0);return false};SP.WOPIMessageHandler.CrossDocumentMessenger.prototype={$4_0:false,_name:"",$3_0:null,$6_0:null,$2_0:null,$5_0:null,$8_0:null,$B_0:null,$A_0:null,$7_0:false,$1_0:null,setName:function(a){ULSudL:;this._name=a},logMessenger:function(d,c,e){ULSudL:;for(var b=[],a=3;a<arguments.length;++a)b[a-3]=arguments[a];SP.WOPIMessageHandler.Debug.log.apply(null,[this._name+": "+d,c,e].concat(b))},enable:function(){ULSudL:;if(SP.WOPIMessageHandler.AFrameworkApplication.isCrossDocumentMessengerDisabled)return false;!SP.WOPIMessageHandler.AFrameworkApplication.theWindowEventManager;if(this.$4_0)return true;if(!SP.WOPIMessageHandler.CrossDocumentMessenger.isPostMessageSupported()){this.$C_0();return false}if(!this.$P_0()){this.$C_0();return false}if(!this.$O_0()){this.$C_0();return false}this.$3_0=[];this.$6_0=[];this.$2_0=[];this.$5_0=[];this.createReceivingAllowList();this.createFreeSendingAllowList();this.$4_0=true;return true},isEnabled:function(){ULSudL:;return this.$4_0},$P_0:function(){ULSudL:;return SP.WOPIMessageHandler.AFrameworkApplication.isCrossDocumentMessengerDisabled?false:true},$O_0:function(){ULSudL:;if(SP.WOPIMessageHandler.AFrameworkApplication.isCrossDocumentMessengerDisabled)return false;if(!this.$7_0){this.$A_0=this.$$d_$R_0;SP.WOPIMessageHandler.AFrameworkApplication.theWindowEventManager.addHandler("message",this.$A_0,null);this.$7_0=true;this.$1_0={}}return true},$C_0:function(){ULSudL:;this.$4_0=false;this.$3_0=null;this.$2_0=null;this.$5_0=null;this.$8_0=null;this.$B_0="";if(this.$7_0){SP.WOPIMessageHandler.AFrameworkApplication.theWindowEventManager.removeHandler("message",this.$A_0);this.$7_0=false;this.$1_0=null}},dispose:function(){ULSudL:;this.$C_0()},createReceivingAllowList:function(){},createReceivingAllowListDebug:function(){ULSudL:;SP.WOPIMessageHandler.Debug.assert(!!this.$3_0)},createFreeSendingAllowList:function(){},createFreeSendingAllowListDebug:function(){ULSudL:;SP.WOPIMessageHandler.Debug.assert(!!this.$2_0)},isMessageReceivingAllowed:function(a){ULSudL:;return!!this.$3_0&&Array.contains(this.$3_0,a)||this.isMessageFreeReceivingAllowed(a)},isMessageFreeReceivingAllowed:function(a){ULSudL:;return!!this.$6_0&&Array.contains(this.$6_0,a)},addAllowedReceivingMessage:function(a){ULSudL:;SP.WOPIMessageHandler.Debug.assertStringTag(!!this.$3_0,"Origin allow list should not be null",840284);Array.add(this.$3_0,a);return true},addAllowedFreeReceivingMessage:function(a){ULSudL:;SP.WOPIMessageHandler.Debug.assertStringTag(!!this.$6_0,"Origin free allow list should not be null",1323648);Array.add(this.$6_0,a);return true},isMessageFreeSendingAllowed:function(a){ULSudL:;return!!this.$2_0&&Array.contains(this.$2_0,a)},addAllowedFreeSendingMessage:function(a){ULSudL:;SP.WOPIMessageHandler.Debug.assertStringTag(!!this.$2_0,"Origin allow list should not be null",840285);Array.add(this.$2_0,a);return true},isOriginAllowed:function(b){ULSudL:;var a=SP.WOPIMessageHandler.UrlUtils.getOrigin(b);return!a?false:!!this.$5_0&&Array.contains(this.$5_0,a)},addAllowedOrigin:function(a){ULSudL:;if(!this.isEnabled())return false;SP.WOPIMessageHandler.Debug.assertStringTag(!!this.$5_0,"Origin allow list should not be null",840286);if(a==="*")return false;var b=SP.WOPIMessageHandler.UrlUtils.getOrigin(a);if(!b)return false;Array.add(this.$5_0,b);return true},send:function(a,d,c){ULSudL:;if(!this.$4_0)return false;if(!a)return false;var e=!d?this.$8_0:d;if(!e)return false;var b=!c?this.$B_0:c;if(!b)return false;if(SP.WOPIMessageHandler.CrossDocumentMessenger.$K()&&b==="*"&&!this.isMessageFreeSendingAllowed(a.MessageId))return false;var h=new Date;a.SendTime=h.getTime();var f="";try{f=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(i){return false}var g=SP.WOPIMessageHandler.CrossDocumentMessenger.sendMessage(e,f,b);g;return g},registerCallback:function(a,b){ULSudL:;if(!this.$4_0)return false;if(!b)return false;if(SP.WOPIMessageHandler.CrossDocumentMessenger.$L()&&!this.isMessageReceivingAllowed(a)){SP.WOPIMessageHandler.Debug.assertStringTag(false,a+" is not allowed to receive.",840287);return false}SP.WOPIMessageHandler.Debug.assert(this.$7_0);SP.WOPIMessageHandler.Debug.assert(!!this.$1_0);if(this.$1_0[a]!==b){if(this.$1_0[a]){SP.WOPIMessageHandler.Debug.assertStringTag(false,"Callback for message "+a+" has been registered. CrossDocument messenger does not allow multiple receiving callbacks.",840288);return false}this.$1_0[a]=b}return true},$R_0:function(c){ULSudL:;var a=this.$N_0(c);if(!a){SP.WOPIMessageHandler.Debug.log("Unexpected post message","CrossDocumentMessenger",0);return false}if(this.$1_0[a.MessageId]){var b=this.$1_0[a.MessageId];b(a)}return false},$N_0:function(a){ULSudL:;var c=new Date;if(!a.origin||!a.source||!a.data)return null;var b=this.$Q_0(a.data);if(!b)return null;if(SP.WOPIMessageHandler.CrossDocumentMessenger.$K()&&!this.isOriginAllowed(a.origin)){if(!this.isMessageFreeReceivingAllowed(b.MessageId))return null;if(!SP.WOPIMessageHandler.BrowserUtils.get_isInternetExplorer8()&&a.source!==this.$8_0)return null}SP.WOPIMessageHandler.Debug.assert(!!b.Values);b.Values.m_Source=a.source;b.Values.m_Origin=a.origin;b.Values.m_ReceivedTime=c.getTime();return b},$Q_0:function(e){ULSudL:;if(!e)return null;var a=null;try{a=Sys.Serialization.JavaScriptSerializer.deserialize(e,true)}catch(h){return null}if(!a)return null;for(var c=0;c<SP.WOPIMessageHandler.CrossDocumentMessenger.$H.length;c++)if(SP.WOPIMessageHandler.DomUtils.isFieldNullOrUndefined(a,SP.WOPIMessageHandler.CrossDocumentMessenger.$H[c]))return null;if(a.Values)try{a.Values}catch(i){return null}if(SP.WOPIMessageHandler.CrossDocumentMessenger.$L()&&!this.isMessageReceivingAllowed(a.MessageId))return null;if(a.SendTime<0)return null;var d=new Date;if(a.SendTime>d.getTime())return null;var f=6e4,g=new Date(d.getTime()-f);if(a.SendTime<g.getTime())return null;var b=new SP.WOPIMessageHandler.CrossDocumentMessage;b.MessageId=a.MessageId;b.SendTime=a.SendTime;if(a.Values)b.Values=a.Values;return b}};SP.WOPIMessageHandler.CrossDocumentMessage.registerClass("SP.WOPIMessageHandler.CrossDocumentMessage");SP.WOPIMessageHandler.AFrameworkApplication.registerClass("SP.WOPIMessageHandler.AFrameworkApplication");SP.WOPIMessageHandler.WindowEventManager.registerClass("SP.WOPIMessageHandler.WindowEventManager");SP.WOPIMessageHandler.EventHandlerArgs.registerClass("SP.WOPIMessageHandler.EventHandlerArgs");SP.WOPIMessageHandler.WindowEventArgs.registerClass("SP.WOPIMessageHandler.WindowEventArgs",SP.WOPIMessageHandler.EventHandlerArgs);SP.WOPIMessageHandler.EventNames.registerClass("SP.WOPIMessageHandler.EventNames");SP.WOPIMessageHandler.BrowserUtils.registerClass("SP.WOPIMessageHandler.BrowserUtils");SP.WOPIMessageHandler.DomUtils.registerClass("SP.WOPIMessageHandler.DomUtils");SP.WOPIMessageHandler.ScriptUtils.registerClass("SP.WOPIMessageHandler.ScriptUtils");SP.WOPIMessageHandler.UrlUtils.registerClass("SP.WOPIMessageHandler.UrlUtils");SP.WOPIMessageHandler.Debug.registerClass("SP.WOPIMessageHandler.Debug");SP.WOPIMessageHandler.ADebugOptionsTab.registerClass("SP.WOPIMessageHandler.ADebugOptionsTab");SP.WOPIMessageHandler.LogCategory.registerClass("SP.WOPIMessageHandler.LogCategory");SP.WOPIMessageHandler.WOPIMessageHandler.registerClass("SP.WOPIMessageHandler.WOPIMessageHandler");SP.WOPIMessageHandler.CrossDocumentMessageId.registerClass("SP.WOPIMessageHandler.CrossDocumentMessageId");SP.WOPIMessageHandler.CrossDocumentMessageFields.registerClass("SP.WOPIMessageHandler.CrossDocumentMessageFields");SP.WOPIMessageHandler.CrossDocumentMessenger.registerClass("SP.WOPIMessageHandler.CrossDocumentMessenger",null,Sys.IDisposable);function sp_wopimessagehandler_initialize(){ULSudL:;SP.WOPIMessageHandler.AFrameworkApplication.isCrossDocumentMessengerDisabled=false;SP.WOPIMessageHandler.AFrameworkApplication.theWindowEventManager=null;SP.WOPIMessageHandler.EventNames.message="message";SP.WOPIMessageHandler.LogCategory.crossDocumentMessenger="CrossDocumentMessenger";SP.WOPIMessageHandler.WOPIMessageHandler.$0=null;SP.WOPIMessageHandler.WOPIMessageHandler.$G=null;SP.WOPIMessageHandler.WOPIMessageHandler.$E=null;SP.WOPIMessageHandler.WOPIMessageHandler.$F=0;SP.WOPIMessageHandler.WOPIMessageHandler.$D=-1;SP.WOPIMessageHandler.CrossDocumentMessageId.close="UI_Close";SP.WOPIMessageHandler.CrossDocumentMessageId.fileProperties="UI_FileProperties";SP.WOPIMessageHandler.CrossDocumentMessageId.sharing="UI_Sharing";SP.WOPIMessageHandler.CrossDocumentMessageId.fileEmbed="UI_FileEmbed";SP.WOPIMessageHandler.CrossDocumentMessageId.copyAndEdit="UI_CopyAndEdit";SP.WOPIMessageHandler.CrossDocumentMessageId.replyWithChanges="UI_ReplyWithChanges";SP.WOPIMessageHandler.CrossDocumentMessageId.fileVersions="UI_FileVersions";SP.WOPIMessageHandler.CrossDocumentMessageId.fileClose="UI_Close";SP.WOPIMessageHandler.CrossDocumentMessageId.openInClient="UI_OpenInClient";SP.WOPIMessageHandler.CrossDocumentMessageId.signIn="UI_SignIn";SP.WOPIMessageHandler.CrossDocumentMessageId.redeemForCommenting="UI_RedeemForCommenting";SP.WOPIMessageHandler.CrossDocumentMessageId.toggleYammerPanel="UI_ToggleYammerPanel";SP.WOPIMessageHandler.CrossDocumentMessageId.blurFocus="BlurFocus";SP.WOPIMessageHandler.CrossDocumentMessageId.grabFocus="GrabFocus";SP.WOPIMessageHandler.CrossDocumentMessageId.shareForm="UI_ShareForm";SP.WOPIMessageHandler.CrossDocumentMessageId.reportAbuse="UI_ReportAbuse";SP.WOPIMessageHandler.CrossDocumentMessageId.fileRename="File_Rename";SP.WOPIMessageHandler.CrossDocumentMessageId.canEmbed="CanEmbed";SP.WOPIMessageHandler.CrossDocumentMessageId.queryLoadingStatus="QueryLoadingStatus";SP.WOPIMessageHandler.CrossDocumentMessageId.appLoadingStatus="App_LoadingStatus";SP.WOPIMessageHandler.CrossDocumentMessageId.appTempError="App_TempError";SP.WOPIMessageHandler.CrossDocumentMessageId.appAllOK="App_AllOK";SP.WOPIMessageHandler.CrossDocumentMessageId.appFatalError=" App_FatalError";SP.WOPIMessageHandler.CrossDocumentMessageId.appNavigated="App_Navigated";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastGlobalId="Broadcast_GlobalId";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastInSync="Broadcast_InSync";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastLinkedNotesInfo="Broadcast_LinkedNotesInfo";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastNavigateToPage="Broadcast_NavigateToPage";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastOpenInClient="Broadcast_OpenInClient";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastOutOfSync="Broadcast_OutOfSync";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastError="Broadcast_Error";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastInitialized="Broadcast_Initialized";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastLocationChanged="Broadcast_LocationChanged";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastMediaState="Broadcast_MediaState";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastNavigate="Broadcast_Navigate";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastResize="Broadcast_Resize";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastSetOptions="Broadcast_SetOptions";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastState="Broadcast_State";SP.WOPIMessageHandler.CrossDocumentMessageId.broadcastSyncToPresenter="Broadcast_SyncToPresenter";SP.WOPIMessageHandler.CrossDocumentMessageId.checkPolicy="CheckPolicy";SP.WOPIMessageHandler.CrossDocumentMessageId.checkPolicyResponse="CheckPolicyResponse";SP.WOPIMessageHandler.CrossDocumentMessageId.hostPerfTiming="Host_PerfTiming";SP.WOPIMessageHandler.CrossDocumentMessageFields.hostPerfTiming_Click="Click";SP.WOPIMessageHandler.CrossDocumentMessageFields.hostPerfTiming_FetchStart="FetchStart";SP.WOPIMessageHandler.CrossDocumentMessageFields.hostPerfTiming_Iframe="Iframe";SP.WOPIMessageHandler.CrossDocumentMessageFields.hostPerfTiming_RedirectCount="RedirectCount";SP.WOPIMessageHandler.CrossDocumentMessageFields.appLoadingStatus_DocumentLoadedTime="DocumentLoadedTime";SP.WOPIMessageHandler.CrossDocumentMessageFields.surveyTitle="SurveyTitle";SP.WOPIMessageHandler.CrossDocumentMessageFields.fileRename_NewName="NewName";SP.WOPIMessageHandler.CrossDocumentMessenger.$H=["MessageId","SendTime"];SP.WOPIMessageHandler.CrossDocumentMessenger.anyDomain="*";SP.WOPIMessageHandler.CrossDocumentMessenger.$I=0}sp_wopimessagehandler_initialize();RegisterModuleInit("sp.wopimessagehandler.js",sp_wopimessagehandler_initialize);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();NotifyScriptLoadedAndExecuteWaitingJobs("SP.WOPIMessageHandler.js");